/****************************************************************************
 *
 *   Copyright (c) 2015 PX4 Development Team. All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in
 *    the documentation and/or other materials provided with the
 *    distribution.
 * 3. Neither the name PX4 nor the names of its contributors may be
 *    used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
 * FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
 * COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
 * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS
 * OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED
 * AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
 * ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 *
 ****************************************************************************/

/**
* @file tailsitter.cpp
*
* @author Roman Bapst 		<bapstroman@gmail.com>
* @author David Vorsin     <davidvorsin@gmail.com>
*
*/
/* xj-zhang add first stage in trans*/
#include <string>
#include "tailsitter.h"
#include "vtol_att_control_main.h"

#define ARSP_YAW_CTRL_DISABLE 4.0f	// airspeed at which we stop controlling yaw during a front transition
#define THROTTLE_TRANSITION_MAX 0.1f	// maximum added thrust above last value in transition
#define PITCH_TRANSITION_FRONT_P1 -0.7f	 // pitch angle to switch to TRANSITION_P2,30 degrees
//#define GROUND_SPEED2_TRANSITION_FRONT_P1	16.0f // ground speed^2 to switch to TRANSITION_P2,5m/s*5m/s
#define PITCH_TRANSITION_FRONT_P2 -1.4f	// pitch angle to switch to FW,80 degrees
#define PITCH_TRANSITION_BACK_P1 -0.9f	// pitch angle to switch to MC,50 degrees
#define PITCH_TRANSITION_BACK_P2 -0.1f	// pitch angle to switch to MC
//xj-zhang
float state_front[3][800]={{0.000100f ,-0.000491f ,0.000455f ,0.000830f ,0.001622f ,0.002756f ,0.004231f ,0.006046f ,0.008199f ,0.010679f ,0.013476f ,0.016575f ,0.019963f ,0.023624f ,0.027545f ,0.031713f ,0.036115f ,0.040739f ,0.045574f ,0.050608f ,0.055831f ,0.061234f ,0.066806f ,0.072540f ,0.078425f ,0.084455f ,0.090622f ,0.096917f ,0.103334f ,0.109867f ,0.116508f ,0.123251f ,0.130090f ,0.137020f ,0.144035f ,0.151129f ,0.158298f ,0.165535f ,0.172836f ,0.180196f ,0.187609f ,0.195065f ,0.202546f ,0.210027f ,0.217484f ,0.224892f ,0.232226f ,0.239464f ,0.246587f ,0.253576f ,0.260417f ,0.267093f ,0.273594f ,0.279909f ,0.286027f ,0.291943f ,0.297649f ,0.303139f ,0.308411f ,0.313460f ,0.318284f ,0.322882f ,0.327253f ,0.331395f ,0.335310f ,0.338998f ,0.342458f ,0.345692f ,0.348702f ,0.351487f ,0.354051f ,0.356394f ,0.358517f ,0.360421f ,0.362107f ,0.363577f ,0.364833f ,0.365876f ,0.366708f ,0.367332f ,0.367749f ,0.367961f ,0.367970f ,0.367778f ,0.367387f ,0.366799f ,0.366014f ,0.365035f ,0.363863f ,0.362500f ,0.360945f ,0.359201f ,0.357267f ,0.355145f ,0.352834f ,0.350336f ,0.347648f ,0.344772f ,0.341707f ,0.338451f ,0.335002f ,0.331358f ,0.327518f ,0.323478f ,0.319237f ,0.314790f ,0.310137f ,0.305273f ,0.300197f ,0.294908f ,0.289404f ,0.283687f ,0.277762f ,0.271635f ,0.265317f ,0.258820f ,0.252156f ,0.245336f ,0.238372f ,0.231274f ,0.224053f ,0.216719f ,0.209281f ,0.201747f ,0.194127f ,0.186429f ,0.178661f ,0.170829f ,0.162943f ,0.155007f ,0.147029f ,0.139016f ,0.130973f ,0.122906f ,0.114821f ,0.106723f ,0.098617f ,0.090507f ,0.082400f ,0.074299f ,0.066208f ,0.058131f ,0.050073f ,0.042038f ,0.034028f ,0.026047f ,0.018099f ,0.010187f ,0.002313f ,-0.005519f ,-0.013307f ,-0.021048f ,-0.028740f ,-0.036379f ,-0.043965f ,-0.051493f ,-0.058964f ,-0.066374f ,-0.073721f ,-0.081004f ,-0.088221f ,-0.095370f ,-0.102450f ,-0.109459f ,-0.116396f ,-0.123258f ,-0.130046f ,-0.136757f ,-0.143390f ,-0.149944f ,-0.156419f ,-0.162812f ,-0.169123f ,-0.175351f ,-0.181495f ,-0.187554f ,-0.193528f ,-0.199414f ,-0.205213f ,-0.210924f ,-0.216545f ,-0.222077f ,-0.227519f ,-0.232870f ,-0.238129f ,-0.243296f ,-0.248370f ,-0.253351f ,-0.258237f ,-0.263030f ,-0.267728f ,-0.272330f ,-0.276837f ,-0.281247f ,-0.285561f ,-0.289777f ,-0.293897f ,-0.297918f ,-0.301842f ,-0.305667f ,-0.309393f ,-0.313020f ,-0.316547f ,-0.319975f ,-0.323303f ,-0.326531f ,-0.329658f ,-0.332685f ,-0.335611f ,-0.338435f ,-0.341159f ,-0.343782f ,-0.346303f ,-0.348724f ,-0.351042f ,-0.353260f ,-0.355376f ,-0.357391f ,-0.359305f ,-0.361117f ,-0.362829f ,-0.364440f ,-0.365951f ,-0.367361f ,-0.368672f ,-0.369883f ,-0.370994f ,-0.372007f ,-0.372921f ,-0.373737f ,-0.374455f ,-0.375076f ,-0.375600f ,-0.376029f ,-0.376362f ,-0.376600f ,-0.376745f ,-0.376795f ,-0.376753f ,-0.376620f ,-0.376395f ,-0.376079f ,-0.375674f ,-0.375181f ,-0.374600f ,-0.373932f ,-0.373178f ,-0.372340f ,-0.371417f ,-0.370412f ,-0.369325f ,-0.368158f ,-0.366911f ,-0.365586f ,-0.364183f ,-0.362705f ,-0.361151f ,-0.359525f ,-0.357826f ,-0.356056f ,-0.354217f ,-0.352309f ,-0.350334f ,-0.348294f ,-0.346190f ,-0.344023f ,-0.341795f ,-0.339507f ,-0.337161f ,-0.334758f ,-0.332300f ,-0.329788f ,-0.327224f ,-0.324610f ,-0.321946f ,-0.319236f ,-0.316480f ,-0.313680f ,-0.310838f ,-0.307955f ,-0.305033f ,-0.302074f ,-0.299080f ,-0.296052f ,-0.292993f ,-0.289903f ,-0.286785f ,-0.283640f ,-0.280471f ,-0.277279f ,-0.274066f ,-0.270833f ,-0.267584f ,-0.264319f ,-0.261040f ,-0.257750f ,-0.254449f ,-0.251141f ,-0.247827f ,-0.244509f ,-0.241189f ,-0.237868f ,-0.234549f ,-0.231233f ,-0.227923f ,-0.224620f ,-0.221327f ,-0.218044f ,-0.214775f ,-0.211520f ,-0.208282f ,-0.205062f ,-0.201863f ,-0.198686f ,-0.195533f ,-0.192405f ,-0.189306f ,-0.186235f ,-0.183195f ,-0.180188f ,-0.177215f ,-0.174278f ,-0.171379f ,-0.168518f ,-0.165699f ,-0.162921f ,-0.160187f ,-0.157498f ,-0.154856f ,-0.152261f ,-0.149716f ,-0.147221f ,-0.144777f ,-0.142387f ,-0.140051f ,-0.137769f ,-0.135544f ,-0.133377f ,-0.131267f ,-0.129217f ,-0.127227f ,-0.125298f ,-0.123430f ,-0.121625f ,-0.119884f ,-0.118205f ,-0.116592f ,-0.115043f ,-0.113559f ,-0.112141f ,-0.110790f ,-0.109505f ,-0.108286f ,-0.107135f ,-0.106051f ,-0.105034f ,-0.104084f ,-0.103202f ,-0.102386f ,-0.101638f ,-0.100957f ,-0.100343f ,-0.099795f ,-0.099314f ,-0.098898f ,-0.098548f ,-0.098263f ,-0.098042f ,-0.097885f ,-0.097792f ,-0.097761f ,-0.097792f ,-0.097884f ,-0.098037f ,-0.098250f ,-0.098521f ,-0.098850f ,-0.099236f ,-0.099677f ,-0.100174f ,-0.100724f ,-0.101327f ,-0.101981f ,-0.102686f ,-0.103440f ,-0.104242f ,-0.105091f ,-0.105985f ,-0.106923f ,-0.107903f ,-0.108925f ,-0.109987f ,-0.111088f ,-0.112226f ,-0.113399f ,-0.114606f ,-0.115847f ,-0.117118f ,-0.118419f ,-0.119749f ,-0.121105f ,-0.122486f ,-0.123891f ,-0.125318f ,-0.126765f ,-0.128231f ,-0.129715f ,-0.131215f ,-0.132729f ,-0.134256f ,-0.135795f ,-0.137343f ,-0.138899f ,-0.140463f ,-0.142031f ,-0.143604f ,-0.145178f ,-0.146754f ,-0.148330f ,-0.149903f ,-0.151474f ,-0.153040f ,-0.154600f ,-0.156152f ,-0.157697f ,-0.159231f ,-0.160755f ,-0.162266f ,-0.163765f ,-0.165249f ,-0.166717f ,-0.168169f ,-0.169603f ,-0.171019f ,-0.172415f ,-0.173791f ,-0.175145f ,-0.176478f ,-0.177787f ,-0.179073f ,-0.180334f ,-0.181570f ,-0.182781f ,-0.183965f ,-0.185123f ,-0.186253f ,-0.187355f ,-0.188429f ,-0.189474f ,-0.190491f ,-0.191478f ,-0.192436f ,-0.193364f ,-0.194262f ,-0.195130f ,-0.195968f ,-0.196776f ,-0.197555f ,-0.198303f ,-0.199021f ,-0.199709f ,-0.200368f ,-0.200997f ,-0.201598f ,-0.202169f ,-0.202712f ,-0.203226f ,-0.203713f ,-0.204173f ,-0.204605f ,-0.205011f ,-0.205391f ,-0.205746f ,-0.206076f ,-0.206382f ,-0.206664f ,-0.206924f ,-0.207161f ,-0.207376f ,-0.207571f ,-0.207746f ,-0.207901f ,-0.208038f ,-0.208157f ,-0.208259f ,-0.208345f ,-0.208416f ,-0.208472f ,-0.208514f ,-0.208543f ,-0.208560f ,-0.208566f ,-0.208561f ,-0.208547f ,-0.208523f ,-0.208492f ,-0.208454f ,-0.208409f ,-0.208358f ,-0.208303f ,-0.208243f ,-0.208180f ,-0.208115f ,-0.208047f ,-0.207978f ,-0.207908f ,-0.207839f ,-0.207770f ,-0.207702f ,-0.207636f ,-0.207572f ,-0.207511f ,-0.207453f ,-0.207399f ,-0.207349f ,-0.207304f ,-0.207263f ,-0.207228f ,-0.207198f ,-0.207174f ,-0.207155f ,-0.207143f ,-0.207138f ,-0.207138f ,-0.207145f ,-0.207159f ,-0.207179f ,-0.207206f ,-0.207239f ,-0.207279f ,-0.207325f ,-0.207376f ,-0.207434f ,-0.207498f ,-0.207567f ,-0.207641f ,-0.207720f ,-0.207803f ,-0.207890f ,-0.207981f ,-0.208075f ,-0.208172f ,-0.208272f ,-0.208373f ,-0.208475f ,-0.208579f ,-0.208682f ,-0.208785f ,-0.208887f ,-0.208988f ,-0.209086f ,-0.209181f ,-0.209273f ,-0.209362f ,-0.209445f ,-0.209523f ,-0.209595f ,-0.209661f ,-0.209719f ,-0.209769f ,-0.209812f ,-0.209845f ,-0.209868f ,-0.209882f ,-0.209885f ,-0.209876f ,-0.209856f ,-0.209824f ,-0.209780f ,-0.209723f ,-0.209652f ,-0.209568f ,-0.209470f ,-0.209358f ,-0.209231f ,-0.209090f ,-0.208935f ,-0.208765f ,-0.208581f ,-0.208382f ,-0.208169f ,-0.207941f ,-0.207700f ,-0.207444f ,-0.207176f ,-0.206894f ,-0.206600f ,-0.206294f ,-0.205977f ,-0.205649f ,-0.205311f ,-0.204964f ,-0.204609f ,-0.204246f ,-0.203877f ,-0.203503f ,-0.203125f ,-0.202743f ,-0.202360f ,-0.201976f ,-0.201594f ,-0.201213f ,-0.200836f ,-0.200465f ,-0.200100f ,-0.199744f ,-0.199398f ,-0.199063f ,-0.198742f ,-0.198436f ,-0.198147f ,-0.197876f ,-0.197626f ,-0.197398f ,-0.197194f ,-0.197016f ,-0.196865f ,-0.196743f ,-0.196652f ,-0.196594f ,-0.196570f ,-0.196582f ,-0.196632f ,-0.196720f ,-0.196848f ,-0.197018f ,-0.197231f ,-0.197488f ,-0.197790f ,-0.198137f ,-0.198532f ,-0.198974f ,-0.199465f ,-0.200004f ,-0.200593f ,-0.201231f ,-0.201918f ,-0.202656f ,-0.203443f ,-0.204280f ,-0.205166f ,-0.206101f ,-0.207085f ,-0.208117f ,-0.209196f ,-0.210323f ,-0.211496f ,-0.212714f ,-0.213978f ,-0.215286f ,-0.216637f ,-0.218031f ,-0.219468f ,-0.220946f ,-0.222466f ,-0.224026f ,-0.225626f ,-0.227267f ,-0.228946f ,-0.230664f ,-0.232421f ,-0.234216f ,-0.236048f ,-0.237918f ,-0.239824f ,-0.241767f ,-0.243744f ,-0.245757f ,-0.247804f ,-0.249885f ,-0.251998f ,-0.254144f ,-0.256320f ,-0.258528f ,-0.260765f ,-0.263031f ,-0.265325f ,-0.267647f ,-0.269995f ,-0.272368f ,-0.274766f ,-0.277188f ,-0.279633f ,-0.282101f ,-0.284590f ,-0.287100f ,-0.289629f ,-0.292179f ,-0.294747f ,-0.297333f ,-0.299936f ,-0.302556f ,-0.305192f ,-0.307844f ,-0.310510f ,-0.313191f ,-0.315885f ,-0.318592f ,-0.321312f ,-0.324043f ,-0.326785f ,-0.329538f ,-0.332301f ,-0.335074f ,-0.337855f ,-0.340644f ,-0.343442f ,-0.346246f ,-0.349058f ,-0.351875f ,-0.354699f ,-0.357527f ,-0.360360f ,-0.363198f ,-0.366039f ,-0.368884f ,-0.371732f ,-0.374582f ,-0.377434f ,-0.380288f ,-0.383143f ,-0.386000f ,-0.388857f ,-0.391714f ,-0.394570f ,-0.397427f ,-0.400282f ,-0.403136f ,-0.405988f ,-0.408839f ,-0.411687f ,-0.414533f ,-0.417375f ,-0.420215f ,-0.423050f ,-0.425882f ,-0.428709f ,-0.431532f ,-0.434350f ,-0.437163f ,-0.439970f ,-0.442771f ,-0.445566f ,-0.448355f ,-0.451138f ,-0.453914f ,-0.456682f ,-0.459444f ,-0.462198f ,-0.464944f ,-0.467683f ,-0.470414f ,-0.473136f ,-0.475850f ,-0.478556f ,-0.481254f ,-0.483942f ,-0.486622f ,-0.489294f ,-0.491956f ,-0.494610f ,-0.497255f ,-0.499892f ,-0.502519f ,-0.505138f ,-0.507748f ,-0.510350f ,-0.512943f ,-0.515527f ,-0.518103f ,-0.520671f ,-0.523230f ,-0.525781f ,-0.528323f ,-0.530857f ,-0.533383f ,-0.535901f ,-0.538410f ,-0.540911f ,-0.543403f ,-0.545888f ,-0.548364f ,-0.550831f ,-0.553290f ,-0.555741f ,-0.558183f ,-0.560616f ,-0.563040f ,-0.565455f ,-0.567861f ,-0.570257f ,-0.572643f ,-0.575018f ,-0.577382f ,-0.579735f ,-0.582075f ,-0.584402f ,-0.586715f ,-0.589013f ,-0.591296f },{90.000000f ,90.000000f ,90.000353f ,90.000654f ,90.000579f ,89.999820f ,89.998090f ,89.995113f ,89.990633f ,89.984405f ,89.976199f ,89.965796f ,89.952994f ,89.937597f ,89.919424f ,89.898304f ,89.874074f ,89.846583f ,89.815689f ,89.781256f ,89.743160f ,89.701281f ,89.655510f ,89.605743f ,89.551882f ,89.493838f ,89.431526f ,89.364866f ,89.293787f ,89.218220f ,89.138101f ,89.053374f ,88.963983f ,88.869879f ,88.771018f ,88.667357f ,88.558858f ,88.445489f ,88.327217f ,88.204015f ,88.075859f ,87.942729f ,87.804607f ,87.661482f ,87.513354f ,87.360228f ,87.202118f ,87.039047f ,86.871043f ,86.698141f ,86.520383f ,86.337814f ,86.150487f ,85.958454f ,85.761775f ,85.560512f ,85.354728f ,85.144489f ,84.929864f ,84.710923f ,84.487737f ,84.260378f ,84.028919f ,83.793434f ,83.553996f ,83.310681f ,83.063562f ,82.812714f ,82.558212f ,82.300132f ,82.038546f ,81.773530f ,81.505158f ,81.233505f ,80.958644f ,80.680649f ,80.399596f ,80.115557f ,79.828606f ,79.538816f ,79.246260f ,78.951011f ,78.653141f ,78.352721f ,78.049823f ,77.744519f ,77.436880f ,77.126976f ,76.814879f ,76.500658f ,76.184385f ,75.866130f ,75.545962f ,75.223953f ,74.900173f ,74.574691f ,74.247580f ,73.918910f ,73.588753f ,73.257179f ,72.924262f ,72.590075f ,72.254690f ,71.918184f ,71.580630f ,71.242107f ,70.902690f ,70.562459f ,70.221492f ,69.879870f ,69.537673f ,69.194981f ,68.851876f ,68.508437f ,68.164741f ,67.820862f ,67.476873f ,67.132840f ,66.788827f ,66.444896f ,66.101105f ,65.757508f ,65.414158f ,65.071103f ,64.728392f ,64.386067f ,64.044171f ,63.702743f ,63.361821f ,63.021440f ,62.681634f ,62.342433f ,62.003867f ,61.665965f ,61.328752f ,60.992253f ,60.656491f ,60.321488f ,59.987264f ,59.653838f ,59.321228f ,58.989449f ,58.658519f ,58.328450f ,57.999257f ,57.670950f ,57.343543f ,57.017044f ,56.691464f ,56.366812f ,56.043094f ,55.720320f ,55.398494f ,55.077623f ,54.757712f ,54.438766f ,54.120788f ,53.803783f ,53.487752f ,53.172699f ,52.858625f ,52.545532f ,52.233421f ,51.922292f ,51.612146f ,51.302983f ,50.994802f ,50.687603f ,50.381384f ,50.076143f ,49.771881f ,49.468593f ,49.166279f ,48.864936f ,48.564561f ,48.265151f ,47.966703f ,47.669214f ,47.372681f ,47.077100f ,46.782467f ,46.488778f ,46.196030f ,45.904219f ,45.613339f ,45.323387f ,45.034358f ,44.746248f ,44.459052f ,44.172766f ,43.887384f ,43.602903f ,43.319316f ,43.036620f ,42.754809f ,42.473878f ,42.193823f ,41.914639f ,41.636320f ,41.358862f ,41.082261f ,40.806513f ,40.531617f ,40.257570f ,39.984373f ,39.712028f ,39.440537f ,39.169906f ,38.900140f ,38.631247f ,38.363237f ,38.096120f ,37.829908f ,37.564615f ,37.300257f ,37.036849f ,36.774410f ,36.512959f ,36.252515f ,35.993101f ,35.734738f ,35.477450f ,35.221261f ,34.966196f ,34.712282f ,34.459545f ,34.208013f ,33.957713f ,33.708674f ,33.460924f ,33.214492f ,32.969407f ,32.725698f ,32.483395f ,32.242525f ,32.003118f ,31.765201f ,31.528802f ,31.293949f ,31.060668f ,30.828985f ,30.598927f ,30.370519f ,30.143784f ,29.918748f ,29.695433f ,29.473863f ,29.254060f ,29.036045f ,28.819840f ,28.605466f ,28.392942f ,28.182287f ,27.973522f ,27.766663f ,27.561730f ,27.358738f ,27.157705f ,26.958647f ,26.761579f ,26.566517f ,26.373474f ,26.182465f ,25.993504f ,25.806602f ,25.621772f ,25.439027f ,25.258378f ,25.079834f ,24.903408f ,24.729107f ,24.556943f ,24.386923f ,24.219055f ,24.053348f ,23.889810f ,23.728445f ,23.569262f ,23.412266f ,23.257463f ,23.104856f ,22.954452f ,22.806253f ,22.660263f ,22.516486f ,22.374923f ,22.235578f ,22.098451f ,21.963545f ,21.830859f ,21.700394f ,21.572150f ,21.446126f ,21.322321f ,21.200733f ,21.081360f ,20.964199f ,20.849246f ,20.736499f ,20.625951f ,20.517598f ,20.411434f ,20.307450f ,20.205640f ,20.105996f ,20.008506f ,19.913161f ,19.819948f ,19.728856f ,19.639871f ,19.552977f ,19.468160f ,19.385401f ,19.304683f ,19.225987f ,19.149293f ,19.074579f ,19.001823f ,18.931001f ,18.862090f ,18.795063f ,18.729893f ,18.666555f ,18.605018f ,18.545253f ,18.487231f ,18.430919f ,18.376286f ,18.323298f ,18.271922f ,18.222124f ,18.173867f ,18.127116f ,18.081834f ,18.037984f ,17.995528f ,17.954427f ,17.914643f ,17.876134f ,17.838862f ,17.802787f ,17.767866f ,17.734060f ,17.701325f ,17.669622f ,17.638907f ,17.609138f ,17.580274f ,17.552271f ,17.525088f ,17.498680f ,17.473007f ,17.448025f ,17.423692f ,17.399965f ,17.376803f ,17.354163f ,17.332004f ,17.310284f ,17.288962f ,17.267997f ,17.247349f ,17.226978f ,17.206843f ,17.186907f ,17.167130f ,17.147474f ,17.127901f ,17.108376f ,17.088860f ,17.069320f ,17.049719f ,17.030024f ,17.010202f ,16.990218f ,16.970042f ,16.949641f ,16.928987f ,16.908049f ,16.886798f ,16.865207f ,16.843250f ,16.820899f ,16.798130f ,16.774919f ,16.751243f ,16.727080f ,16.702409f ,16.677208f ,16.651460f ,16.625146f ,16.598249f ,16.570753f ,16.542643f ,16.513904f ,16.484524f ,16.454491f ,16.423793f ,16.392422f ,16.360368f ,16.327623f ,16.294180f ,16.260034f ,16.225180f ,16.189615f ,16.153335f ,16.116338f ,16.078626f ,16.040196f ,16.001052f ,15.961194f ,15.920626f ,15.879353f ,15.837379f ,15.794711f ,15.751354f ,15.707318f ,15.662609f ,15.617239f ,15.571217f ,15.524553f ,15.477261f ,15.429352f ,15.380839f ,15.331738f ,15.282062f ,15.231826f ,15.181048f ,15.129743f ,15.077929f ,15.025624f ,14.972845f ,14.919612f ,14.865944f ,14.811861f ,14.757383f ,14.702530f ,14.647324f ,14.591786f ,14.535938f ,14.479801f ,14.423398f ,14.366750f ,14.309882f ,14.252814f ,14.195571f ,14.138175f ,14.080650f ,14.023017f ,13.965301f ,13.907524f ,13.849710f ,13.791882f ,13.734061f ,13.676272f ,13.618536f ,13.560875f ,13.503313f ,13.445870f ,13.388569f ,13.331430f ,13.274474f ,13.217723f ,13.161195f ,13.104912f ,13.048891f ,12.993153f ,12.937715f ,12.882595f ,12.827811f ,12.773378f ,12.719314f ,12.665634f ,12.612353f ,12.559486f ,12.507045f ,12.455044f ,12.403495f ,12.352410f ,12.301799f ,12.251674f ,12.202043f ,12.152915f ,12.104297f ,12.056198f ,12.008624f ,11.961580f ,11.915070f ,11.869100f ,11.823672f ,11.778789f ,11.734452f ,11.690663f ,11.647422f ,11.604727f ,11.562579f ,11.520973f ,11.479909f ,11.439381f ,11.399386f ,11.359919f ,11.320974f ,11.282545f ,11.244624f ,11.207203f ,11.170276f ,11.133832f ,11.097862f ,11.062356f ,11.027304f ,10.992694f ,10.958514f ,10.924754f ,10.891399f ,10.858438f ,10.825857f ,10.793642f ,10.761780f ,10.730255f ,10.699054f ,10.668162f ,10.637564f ,10.607244f ,10.577188f ,10.547380f ,10.517804f ,10.488444f ,10.459286f ,10.430314f ,10.401513f ,10.372866f ,10.344358f ,10.315975f ,10.287701f ,10.259522f ,10.231423f ,10.203390f ,10.175409f ,10.147467f ,10.119549f ,10.091644f ,10.063739f ,10.035822f ,10.007882f ,9.979907f ,9.951888f ,9.923814f ,9.895678f ,9.867469f ,9.839180f ,9.810804f ,9.782335f ,9.753766f ,9.725094f ,9.696313f ,9.667420f ,9.638413f ,9.609290f ,9.580049f ,9.550692f ,9.521218f ,9.491630f ,9.461929f ,9.432120f ,9.402207f ,9.372195f ,9.342090f ,9.311900f ,9.281631f ,9.251295f ,9.220899f ,9.190455f ,9.159974f ,9.129469f ,9.098953f ,9.068441f ,9.037946f ,9.007485f ,8.977073f ,8.946730f ,8.916471f ,8.886315f ,8.856282f ,8.826392f ,8.796664f ,8.767120f ,8.737779f ,8.708665f ,8.679799f ,8.651203f ,8.622899f ,8.594910f ,8.567259f ,8.539968f ,8.513060f ,8.486558f ,8.460483f ,8.434858f ,8.409705f ,8.385045f ,8.360898f ,8.337286f ,8.314226f ,8.291739f ,8.269842f ,8.248552f ,8.227886f ,8.207857f ,8.188479f ,8.169766f ,8.151728f ,8.134374f ,8.117712f ,8.101750f ,8.086491f ,8.071938f ,8.058093f ,8.044954f ,8.032520f ,8.020785f ,8.009742f ,7.999383f ,7.989696f ,7.980670f ,7.972288f ,7.964535f ,7.957391f ,7.950836f ,7.944846f ,7.939399f ,7.934467f ,7.930024f ,7.926040f ,7.922487f ,7.919334f ,7.916548f ,7.914099f ,7.911954f ,7.910081f ,7.908448f ,7.907025f ,7.905781f ,7.904688f ,7.903720f ,7.902851f ,7.902058f ,7.901322f ,7.900626f ,7.899955f ,7.899297f ,7.898644f ,7.897989f ,7.897328f ,7.896659f ,7.895981f ,7.895295f ,7.894603f ,7.893907f ,7.893209f ,7.892513f ,7.891822f ,7.891137f ,7.890462f ,7.889796f ,7.889143f ,7.888503f ,7.887876f ,7.887262f ,7.886661f ,7.886073f ,7.885496f ,7.884931f ,7.884376f ,7.883831f ,7.883294f ,7.882765f ,7.882244f ,7.881730f ,7.881223f ,7.880722f ,7.880227f ,7.879739f ,7.879257f ,7.878780f ,7.878310f ,7.877845f ,7.877385f ,7.876931f ,7.876482f ,7.876038f ,7.875599f ,7.875164f ,7.874734f ,7.874309f ,7.873887f ,7.873470f ,7.873056f ,7.872646f ,7.872240f ,7.871837f ,7.871438f ,7.871042f ,7.870649f ,7.870259f ,7.869872f ,7.869488f ,7.869107f ,7.868729f ,7.868353f ,7.867981f ,7.867611f ,7.867243f ,7.866878f ,7.866516f ,7.866156f ,7.865798f ,7.865443f ,7.865090f ,7.864739f ,7.864391f ,7.864045f ,7.863701f ,7.863359f ,7.863019f ,7.862681f ,7.862346f ,7.862012f ,7.861681f ,7.861352f ,7.861024f ,7.860699f ,7.860376f ,7.860055f ,7.859735f ,7.859418f ,7.859102f ,7.858789f ,7.858477f ,7.858168f ,7.857860f ,7.857554f ,7.857251f ,7.856949f ,7.856649f ,7.856350f ,7.856054f ,7.855759f ,7.855467f ,7.855176f ,7.854886f ,7.854599f ,7.854313f ,7.854030f ,7.853747f ,7.853467f ,7.853188f ,7.852911f ,7.852636f ,7.852362f ,7.852090f ,7.851820f ,7.851551f ,7.851283f ,7.851017f ,7.850753f ,7.850490f ,7.850228f ,7.849968f ,7.849709f ,7.849452f ,7.849196f ,7.848941f ,7.848687f ,7.848435f ,7.848184f ,7.847933f ,7.847685f ,7.847437f ,7.847190f ,7.846944f ,7.846700f ,7.846456f ,7.846213f ,7.845971f ,7.845730f ,7.845490f ,7.845251f ,7.845012f ,7.844774f ,7.844537f ,7.844301f ,7.844065f ,7.843830f ,7.843596f ,7.843361f ,7.843127f ,7.842893f ,7.842661f ,7.842431f ,7.842201f },{0.566641f ,0.565865f ,0.562140f ,0.558616f ,0.555277f ,0.552111f ,0.549105f ,0.546253f ,0.543545f ,0.540976f ,0.538538f ,0.536225f ,0.534032f ,0.531953f ,0.529982f ,0.528114f ,0.526345f ,0.524670f ,0.523084f ,0.521585f ,0.520167f ,0.518828f ,0.517564f ,0.516372f ,0.515249f ,0.514192f ,0.513199f ,0.512268f ,0.511396f ,0.510581f ,0.509823f ,0.509119f ,0.508469f ,0.507871f ,0.507324f ,0.506830f ,0.506387f ,0.505995f ,0.505658f ,0.505391f ,0.505263f ,0.505412f ,0.505948f ,0.506902f ,0.508269f ,0.510025f ,0.512138f ,0.514576f ,0.517305f ,0.520293f ,0.523511f ,0.526928f ,0.530516f ,0.534252f ,0.538113f ,0.542078f ,0.546127f ,0.550244f ,0.554414f ,0.558623f ,0.562861f ,0.567117f ,0.571383f ,0.575653f ,0.579922f ,0.584185f ,0.588440f ,0.592685f ,0.596916f ,0.601132f ,0.605334f ,0.609527f ,0.613720f ,0.617908f ,0.622087f ,0.626249f ,0.630393f ,0.634519f ,0.638630f ,0.642725f ,0.646805f ,0.650873f ,0.654929f ,0.658975f ,0.663014f ,0.667047f ,0.671077f ,0.675106f ,0.679138f ,0.683176f ,0.687223f ,0.691282f ,0.695358f ,0.699455f ,0.703578f ,0.707730f ,0.711916f ,0.716141f ,0.720415f ,0.724748f ,0.729146f ,0.733613f ,0.738152f ,0.742766f ,0.747456f ,0.752222f ,0.757064f ,0.761974f ,0.766942f ,0.771949f ,0.776961f ,0.781924f ,0.786777f ,0.791467f ,0.795968f ,0.800274f ,0.804388f ,0.808318f ,0.812070f ,0.815652f ,0.819071f ,0.822335f ,0.825450f ,0.828422f ,0.831258f ,0.833963f ,0.836544f ,0.839005f ,0.841352f ,0.843590f ,0.845724f ,0.847758f ,0.849697f ,0.851545f ,0.853306f ,0.854984f ,0.856582f ,0.858105f ,0.859555f ,0.860936f ,0.862251f ,0.863503f ,0.864695f ,0.865829f ,0.866908f ,0.867935f ,0.868912f ,0.869841f ,0.870724f ,0.871563f ,0.872361f ,0.873119f ,0.873839f ,0.874523f ,0.875172f ,0.875788f ,0.876372f ,0.876926f ,0.877451f ,0.877949f ,0.878420f ,0.878867f ,0.879289f ,0.879688f ,0.880066f ,0.880422f ,0.880759f ,0.881076f ,0.881375f ,0.881657f ,0.881922f ,0.882172f ,0.882406f ,0.882625f ,0.882831f ,0.883023f ,0.883203f ,0.883371f ,0.883527f ,0.883672f ,0.883807f ,0.883932f ,0.884047f ,0.884152f ,0.884249f ,0.884337f ,0.884418f ,0.884490f ,0.884555f ,0.884613f ,0.884664f ,0.884708f ,0.884747f ,0.884779f ,0.884805f ,0.884826f ,0.884842f ,0.884852f ,0.884858f ,0.884859f ,0.884856f ,0.884848f ,0.884836f ,0.884821f ,0.884801f ,0.884779f ,0.884752f ,0.884723f ,0.884690f ,0.884654f ,0.884616f ,0.884575f ,0.884531f ,0.884485f ,0.884436f ,0.884385f ,0.884332f ,0.884277f ,0.884220f ,0.884162f ,0.884101f ,0.884039f ,0.883975f ,0.883910f ,0.883843f ,0.883775f ,0.883706f ,0.883636f ,0.883564f ,0.883492f ,0.883419f ,0.883344f ,0.883269f ,0.883194f ,0.883117f ,0.883040f ,0.882963f ,0.882885f ,0.882806f ,0.882728f ,0.882649f ,0.882570f ,0.882490f ,0.882411f ,0.882331f ,0.882252f ,0.882173f ,0.882093f ,0.882014f ,0.881935f ,0.881857f ,0.881779f ,0.881701f ,0.881624f ,0.881547f ,0.881470f ,0.881394f ,0.881319f ,0.881245f ,0.881171f ,0.881098f ,0.881026f ,0.880954f ,0.880884f ,0.880814f ,0.880745f ,0.880677f ,0.880610f ,0.880544f ,0.880479f ,0.880415f ,0.880352f ,0.880291f ,0.880230f ,0.880170f ,0.880112f ,0.880054f ,0.879998f ,0.879943f ,0.879889f ,0.879836f ,0.879784f ,0.879733f ,0.879683f ,0.879634f ,0.879587f ,0.879540f ,0.879495f ,0.879450f ,0.879407f ,0.879364f ,0.879322f ,0.879282f ,0.879242f ,0.879202f ,0.879164f ,0.879126f ,0.879090f ,0.879053f ,0.879018f ,0.878983f ,0.878948f ,0.878914f ,0.878880f ,0.878847f ,0.878814f ,0.878781f ,0.878749f ,0.878717f ,0.878684f ,0.878652f ,0.878620f ,0.878587f ,0.878555f ,0.878523f ,0.878490f ,0.878458f ,0.878425f ,0.878392f ,0.878358f ,0.878325f ,0.878291f ,0.878257f ,0.878223f ,0.878188f ,0.878153f ,0.878117f ,0.878081f ,0.878044f ,0.878007f ,0.877970f ,0.877931f ,0.877893f ,0.877853f ,0.877813f ,0.877772f ,0.877731f ,0.877689f ,0.877646f ,0.877602f ,0.877558f ,0.877512f ,0.877466f ,0.877419f ,0.877371f ,0.877322f ,0.877273f ,0.877222f ,0.877170f ,0.877118f ,0.877064f ,0.877009f ,0.876953f ,0.876896f ,0.876838f ,0.876779f ,0.876719f ,0.876658f ,0.876595f ,0.876532f ,0.876467f ,0.876401f ,0.876333f ,0.876265f ,0.876195f ,0.876124f ,0.876052f ,0.875979f ,0.875904f ,0.875828f ,0.875751f ,0.875672f ,0.875593f ,0.875512f ,0.875429f ,0.875345f ,0.875260f ,0.875174f ,0.875087f ,0.874998f ,0.874907f ,0.874816f ,0.874723f ,0.874629f ,0.874533f ,0.874437f ,0.874339f ,0.874239f ,0.874139f ,0.874037f ,0.873933f ,0.873829f ,0.873723f ,0.873616f ,0.873508f ,0.873398f ,0.873288f ,0.873176f ,0.873062f ,0.872948f ,0.872832f ,0.872715f ,0.872598f ,0.872478f ,0.872358f ,0.872237f ,0.872114f ,0.871990f ,0.871866f ,0.871740f ,0.871613f ,0.871485f ,0.871356f ,0.871226f ,0.871095f ,0.870963f ,0.870831f ,0.870697f ,0.870562f ,0.870426f ,0.870290f ,0.870153f ,0.870015f ,0.869876f ,0.869736f ,0.869595f ,0.869454f ,0.869312f ,0.869169f ,0.869026f ,0.868882f ,0.868737f ,0.868592f ,0.868446f ,0.868300f ,0.868153f ,0.868005f ,0.867857f ,0.867709f ,0.867560f ,0.867411f ,0.867261f ,0.867111f ,0.866960f ,0.866810f ,0.866659f ,0.866507f ,0.866356f ,0.866204f ,0.866052f ,0.865900f ,0.865747f ,0.865595f ,0.865442f ,0.865289f ,0.865137f ,0.864984f ,0.864831f ,0.864678f ,0.864525f ,0.864372f ,0.864220f ,0.864067f ,0.863915f ,0.863762f ,0.863610f ,0.863458f ,0.863306f ,0.863154f ,0.863003f ,0.862852f ,0.862701f ,0.862551f ,0.862400f ,0.862250f ,0.862101f ,0.861952f ,0.861803f ,0.861654f ,0.861506f ,0.861359f ,0.861212f ,0.861065f ,0.860918f ,0.860772f ,0.860627f ,0.860481f ,0.860336f ,0.860191f ,0.860046f ,0.859901f ,0.859757f ,0.859612f ,0.859467f ,0.859322f ,0.859177f ,0.859032f ,0.858887f ,0.858741f ,0.858594f ,0.858447f ,0.858300f ,0.858152f ,0.858003f ,0.857854f ,0.857703f ,0.857552f ,0.857400f ,0.857248f ,0.857094f ,0.856939f ,0.856783f ,0.856626f ,0.856468f ,0.856309f ,0.856149f ,0.855987f ,0.855824f ,0.855660f ,0.855495f ,0.855328f ,0.855160f ,0.854990f ,0.854819f ,0.854647f ,0.854473f ,0.854297f ,0.854120f ,0.853942f ,0.853762f ,0.853580f ,0.853397f ,0.853212f ,0.853026f ,0.852838f ,0.852648f ,0.852456f ,0.852263f ,0.852068f ,0.851871f ,0.851672f ,0.851471f ,0.851268f ,0.851063f ,0.850856f ,0.850647f ,0.850436f ,0.850222f ,0.850006f ,0.849787f ,0.849566f ,0.849342f ,0.849115f ,0.848885f ,0.848651f ,0.848415f ,0.848175f ,0.847931f ,0.847684f ,0.847433f ,0.847177f ,0.846917f ,0.846653f ,0.846384f ,0.846111f ,0.845832f ,0.845548f ,0.845258f ,0.844962f ,0.844661f ,0.844353f ,0.844039f ,0.843718f ,0.843390f ,0.843054f ,0.842711f ,0.842360f ,0.842000f ,0.841633f ,0.841256f ,0.840870f ,0.840475f ,0.840071f ,0.839657f ,0.839233f ,0.838798f ,0.838354f ,0.837900f ,0.837435f ,0.836960f ,0.836474f ,0.835978f ,0.835472f ,0.834956f ,0.834430f ,0.833894f ,0.833348f ,0.832793f ,0.832230f ,0.831659f ,0.831080f ,0.830494f ,0.829902f ,0.829305f ,0.828704f ,0.828099f ,0.827493f ,0.826886f ,0.826279f ,0.825675f ,0.825074f ,0.824478f ,0.823889f ,0.823307f ,0.822735f ,0.822174f ,0.821624f ,0.821088f ,0.820565f ,0.820057f ,0.819565f ,0.819088f ,0.818626f ,0.818180f ,0.817749f ,0.817331f ,0.816926f ,0.816532f ,0.816149f ,0.815773f ,0.815402f ,0.815035f ,0.814668f ,0.814299f ,0.813924f ,0.813542f ,0.813147f ,0.812736f ,0.812306f ,0.811853f ,0.811371f ,0.810858f ,0.810310f ,0.809722f ,0.809091f ,0.808418f ,0.807700f ,0.806942f ,0.806146f ,0.805319f ,0.804468f ,0.803601f ,0.802727f ,0.801854f ,0.800989f ,0.800137f ,0.799302f ,0.798488f ,0.797695f ,0.796922f ,0.796168f ,0.795427f ,0.794696f ,0.793968f ,0.793237f ,0.792494f ,0.791734f ,0.790949f ,0.790132f ,0.789279f ,0.788384f ,0.787442f ,0.786451f ,0.785407f ,0.784309f ,0.783153f ,0.781939f ,0.780665f ,0.779331f ,0.777938f ,0.776488f ,0.774983f ,0.773427f ,0.771822f ,0.770173f ,0.768481f ,0.766748f ,0.764978f ,0.763171f ,0.761328f ,0.759450f ,0.757538f ,0.755594f ,0.753616f ,0.751608f ,0.749568f ,0.747498f ,0.745398f ,0.743269f ,0.741111f ,0.738926f ,0.736715f ,0.734477f ,0.732214f ,0.729928f ,0.727618f ,0.725288f ,0.722937f ,0.720567f ,0.718180f ,0.715777f ,0.713359f ,0.710928f ,0.708485f ,0.706030f ,0.703566f ,0.701093f ,0.698612f ,0.696125f ,0.693630f ,0.691131f ,0.688626f ,0.686116f ,0.683603f ,0.681086f ,0.678565f ,0.676041f ,0.673513f ,0.670982f ,0.668448f ,0.665911f ,0.663370f ,0.660827f ,0.658279f ,0.655729f ,0.653176f ,0.650619f ,0.648061f ,0.645501f ,0.642940f ,0.640379f ,0.637820f ,0.635263f ,0.632710f ,0.630161f ,0.627620f ,0.625085f ,0.622559f ,0.620042f ,0.617536f ,0.615041f ,0.612559f ,0.610091f ,0.607638f ,0.605203f ,0.602787f ,0.600392f ,0.598021f ,0.595676f ,0.593360f ,0.591074f ,0.588819f ,0.586596f ,0.584406f ,0.582248f ,0.580123f ,0.578028f ,0.575963f ,0.573928f ,0.571920f ,0.569939f ,0.567983f ,0.566050f ,0.564139f ,0.562246f ,0.560371f ,0.558512f ,0.556665f ,0.554830f ,0.553005f ,0.551190f ,0.549382f ,0.547579f ,0.545780f ,0.543979f ,0.542172f ,0.540354f ,0.538519f ,0.536660f ,0.534771f ,0.532843f ,0.530867f ,0.528831f ,0.526719f ,0.524513f ,0.522191f ,0.519750f ,0.517223f ,0.514658f ,0.512089f }};
float state_back[3][800]={{0.000000f ,-0.011858f ,-0.023644f ,-0.035308f ,-0.046848f ,-0.058270f ,-0.069583f ,-0.080796f ,-0.091923f ,-0.102974f ,-0.113965f ,-0.124909f ,-0.135822f ,-0.146720f ,-0.157618f ,-0.168532f ,-0.179481f ,-0.190481f ,-0.201549f ,-0.212702f ,-0.223959f ,-0.235336f ,-0.246851f ,-0.258521f ,-0.270364f ,-0.282396f ,-0.294634f ,-0.307095f ,-0.319796f ,-0.332751f ,-0.345977f ,-0.359488f ,-0.373300f ,-0.387426f ,-0.401880f ,-0.416676f ,-0.431827f ,-0.447343f ,-0.463238f ,-0.479521f ,-0.496204f ,-0.513296f ,-0.530806f ,-0.548743f ,-0.567113f ,-0.585925f ,-0.605185f ,-0.624898f ,-0.645068f ,-0.665701f ,-0.686800f ,-0.708366f ,-0.730403f ,-0.752911f ,-0.775892f ,-0.799350f ,-0.823286f ,-0.847701f ,-0.872596f ,-0.897972f ,-0.923827f ,-0.950162f ,-0.976974f ,-1.004262f ,-1.032023f ,-1.060256f ,-1.088956f ,-1.118120f ,-1.147744f ,-1.177824f ,-1.208354f ,-1.239330f ,-1.270747f ,-1.302597f ,-1.334876f ,-1.367577f ,-1.400693f ,-1.434217f ,-1.468142f ,-1.502461f ,-1.536990f ,-1.571717f ,-1.606627f ,-1.641706f ,-1.676939f ,-1.712313f ,-1.747815f ,-1.783430f ,-1.819146f ,-1.854949f ,-1.890826f ,-1.926766f ,-1.962756f ,-1.998783f ,-2.034837f ,-2.070905f ,-2.106977f ,-2.143042f ,-2.179088f ,-2.215107f ,-2.251087f ,-2.287019f ,-2.322894f ,-2.358702f ,-2.394435f ,-2.430085f ,-2.465643f ,-2.501102f ,-2.536453f ,-2.571690f ,-2.606806f ,-2.641794f ,-2.676647f ,-2.711360f ,-2.745928f ,-2.780344f ,-2.814603f ,-2.848700f ,-2.882632f ,-2.916393f ,-2.949979f ,-2.983387f ,-3.016612f ,-3.049653f ,-3.082505f ,-3.115166f ,-3.147633f ,-3.179904f ,-3.211976f ,-3.243849f ,-3.275519f ,-3.306985f ,-3.338247f ,-3.369301f ,-3.400148f ,-3.430787f ,-3.461216f ,-3.491436f ,-3.521445f ,-3.551244f ,-3.580833f ,-3.610212f ,-3.639380f ,-3.668338f ,-3.697088f ,-3.725628f ,-3.753960f ,-3.782085f ,-3.810004f ,-3.837717f ,-3.865226f ,-3.892532f ,-3.919635f ,-3.946538f ,-3.973241f ,-3.999747f ,-4.026056f ,-4.052170f ,-4.078091f ,-4.103820f ,-4.129360f ,-4.154710f ,-4.179875f ,-4.204854f ,-4.229650f ,-4.254265f ,-4.278701f ,-4.302959f ,-4.327041f ,-4.350949f ,-4.374684f ,-4.398250f ,-4.421647f ,-4.444878f ,-4.467943f ,-4.490846f ,-4.513587f ,-4.536169f ,-4.558593f ,-4.580862f ,-4.602976f ,-4.624938f ,-4.646749f ,-4.668411f ,-4.689926f ,-4.711295f ,-4.732519f ,-4.753601f ,-4.774542f ,-4.795343f ,-4.816007f ,-4.836533f ,-4.856925f ,-4.877182f ,-4.897308f ,-4.917302f ,-4.937166f ,-4.956901f ,-4.976509f ,-4.995991f ,-5.015348f ,-5.034582f ,-5.053693f ,-5.072684f ,-5.091556f ,-5.110308f ,-5.128944f ,-5.147463f ,-5.165866f ,-5.184154f ,-5.202328f ,-5.220388f ,-5.238337f ,-5.256173f ,-5.273899f ,-5.291515f ,-5.309021f ,-5.326418f ,-5.343707f ,-5.360889f ,-5.377964f ,-5.394932f ,-5.411794f ,-5.428551f ,-5.445203f ,-5.461750f ,-5.478194f ,-5.494534f ,-5.510770f ,-5.526904f ,-5.542936f ,-5.558865f ,-5.574693f ,-5.590419f ,-5.606044f ,-5.621568f ,-5.636992f ,-5.652315f ,-5.667538f ,-5.682661f ,-5.697684f ,-5.712608f ,-5.727432f ,-5.742157f ,-5.756783f ,-5.771311f ,-5.785739f ,-5.800069f ,-5.814301f ,-5.828434f ,-5.842468f ,-5.856405f ,-5.870243f ,-5.883983f ,-5.897626f ,-5.911170f ,-5.924617f ,-5.937965f ,-5.951216f ,-5.964369f ,-5.977424f ,-5.990382f ,-6.003242f ,-6.016004f ,-6.028668f ,-6.041235f ,-6.053704f ,-6.066076f ,-6.078349f ,-6.090525f ,-6.102603f ,-6.114584f ,-6.126466f ,-6.138251f ,-6.149938f ,-6.161527f ,-6.173019f ,-6.184412f ,-6.195708f ,-6.206905f ,-6.218005f ,-6.229006f ,-6.239909f ,-6.250714f ,-6.261421f ,-6.272030f ,-6.282541f ,-6.292953f ,-6.303267f ,-6.313482f ,-6.323599f ,-6.333618f ,-6.343538f ,-6.353359f ,-6.363082f ,-6.372706f ,-6.382232f ,-6.391659f ,-6.400987f ,-6.410217f ,-6.419347f ,-6.428379f ,-6.437312f ,-6.446146f ,-6.454881f ,-6.463518f ,-6.472055f ,-6.480493f ,-6.488833f ,-6.497073f ,-6.505214f ,-6.513257f ,-6.521200f ,-6.529044f ,-6.536790f ,-6.544436f ,-6.551983f ,-6.559432f ,-6.566781f ,-6.574032f ,-6.581184f ,-6.588236f ,-6.595190f ,-6.602046f ,-6.608802f ,-6.615460f ,-6.622019f ,-6.628480f ,-6.634842f ,-6.641106f ,-6.647272f ,-6.653340f ,-6.659310f ,-6.665182f ,-6.670956f ,-6.676633f ,-6.682212f ,-6.687695f ,-6.693080f ,-6.698369f ,-6.703563f ,-6.708660f ,-6.713663f ,-6.718570f ,-6.723385f ,-6.728106f ,-6.732736f ,-6.737276f ,-6.741729f ,-6.746099f ,-6.750394f ,-6.754665f ,-6.758932f ,-6.763204f ,-6.767484f ,-6.771773f ,-6.776071f ,-6.780378f ,-6.784698f ,-6.789034f ,-6.793383f ,-6.797749f ,-6.802133f ,-6.806535f ,-6.810953f ,-6.815389f ,-6.819842f ,-6.824310f ,-6.828792f ,-6.833289f ,-6.837798f ,-6.842316f ,-6.846844f ,-6.851379f ,-6.855920f ,-6.860462f ,-6.865003f ,-6.869539f ,-6.874064f ,-6.878572f ,-6.883062f ,-6.887526f ,-6.891956f ,-6.896348f ,-6.900697f ,-6.905000f ,-6.909256f ,-6.913458f ,-6.917602f ,-6.921692f ,-6.925717f ,-6.929681f ,-6.933574f ,-6.937398f ,-6.941159f ,-6.944848f ,-6.948470f ,-6.952028f ,-6.955511f ,-6.958920f ,-6.962259f ,-6.965531f ,-6.968736f ,-6.971869f ,-6.974951f ,-6.978001f ,-6.981015f ,-6.984003f ,-6.986958f ,-6.989889f ,-6.992806f ,-6.995715f ,-6.998606f ,-7.001495f ,-7.004388f ,-7.007272f ,-7.010161f ,-7.013046f ,-7.015932f ,-7.018823f ,-7.021718f ,-7.024625f ,-7.027543f ,-7.030476f ,-7.033417f ,-7.036379f ,-7.039356f ,-7.042361f ,-7.045381f ,-7.048397f ,-7.051395f ,-7.054367f ,-7.057307f ,-7.060212f ,-7.063089f ,-7.065929f ,-7.068734f ,-7.071500f ,-7.074226f ,-7.076893f ,-7.079510f ,-7.082079f ,-7.084590f ,-7.087042f ,-7.089430f ,-7.091760f ,-7.094037f ,-7.096250f ,-7.098398f ,-7.100486f ,-7.102509f ,-7.104458f ,-7.106347f ,-7.108164f ,-7.109916f ,-7.111594f ,-7.113202f ,-7.114731f ,-7.116190f ,-7.117562f ,-7.118855f ,-7.120070f ,-7.121218f ,-7.122304f ,-7.123326f ,-7.124297f ,-7.125239f ,-7.126127f ,-7.126938f ,-7.127710f ,-7.128446f ,-7.129137f ,-7.129784f ,-7.130372f ,-7.130891f ,-7.131337f ,-7.131723f ,-7.132154f ,-7.132556f ,-7.132880f ,-7.133137f ,-7.133404f ,-7.133609f ,-7.133790f ,-7.133909f ,-7.134023f ,-7.134219f ,-7.134353f ,-7.134440f ,-7.134478f ,-7.134545f ,-7.134554f ,-7.134533f ,-7.134486f ,-7.134519f ,-7.134532f ,-7.134489f ,-7.134454f ,-7.134407f ,-7.134287f ,-7.134149f ,-7.134032f ,-7.133912f ,-7.133762f ,-7.133547f ,-7.133238f ,-7.132840f ,-7.132340f ,-7.131741f ,-7.131064f ,-7.130313f ,-7.129748f ,-7.129109f ,-7.128390f ,-7.127564f ,-7.126653f ,-7.125637f ,-7.124529f ,-7.123350f ,-7.122178f ,-7.121031f ,-7.119800f ,-7.118506f ,-7.117118f ,-7.115628f ,-7.114047f ,-7.112361f ,-7.110581f ,-7.108702f ,-7.106734f ,-7.104669f ,-7.102520f ,-7.100306f ,-7.098026f ,-7.095678f ,-7.093280f ,-7.090838f ,-7.088416f ,-7.086150f ,-7.083975f ,-7.081791f ,-7.079567f ,-7.077294f ,-7.074967f ,-7.072585f ,-7.070144f ,-7.067633f ,-7.065061f ,-7.062427f ,-7.059724f ,-7.056959f ,-7.054129f ,-7.051222f ,-7.048245f ,-7.045198f ,-7.042091f ,-7.038934f ,-7.035717f ,-7.032437f ,-7.029093f ,-7.025696f ,-7.022248f ,-7.018748f ,-7.015195f ,-7.011578f ,-7.007917f ,-7.004197f ,-7.000419f ,-6.996596f ,-6.992723f ,-6.988790f ,-6.984816f ,-6.980796f ,-6.976723f ,-6.972600f ,-6.968445f ,-6.964247f ,-6.960010f ,-6.955729f ,-6.951437f ,-6.947107f ,-6.942767f ,-6.938405f ,-6.934021f ,-6.929609f ,-6.925183f ,-6.920718f ,-6.916260f ,-6.911784f ,-6.907292f ,-6.902810f ,-6.898337f ,-6.893883f ,-6.889434f ,-6.885067f ,-6.880697f ,-6.876314f ,-6.871997f ,-6.867955f ,-6.864117f ,-6.860482f ,-6.857096f ,-6.853907f ,-6.850770f ,-6.847645f ,-6.844450f ,-6.841196f ,-6.838086f ,-6.834987f ,-6.831899f ,-6.828742f ,-6.825712f ,-6.822661f ,-6.819812f ,-6.817035f ,-6.814612f ,-6.812373f ,-6.810006f ,-6.807929f ,-6.805720f ,-6.803771f ,-6.802218f ,-6.800544f ,-6.798595f ,-6.796331f ,-6.793737f ,-6.790809f ,-6.787550f ,-6.783962f ,-6.780052f ,-6.775827f ,-6.771295f ,-6.766464f ,-6.761342f ,-6.755938f ,-6.750261f ,-6.744319f ,-6.738121f ,-6.731674f ,-6.724988f ,-6.718069f ,-6.710926f ,-6.703566f ,-6.695997f ,-6.688225f ,-6.680257f ,-6.672101f ,-6.663763f ,-6.655248f ,-6.646564f ,-6.637715f ,-6.628708f ,-6.619548f ,-6.610241f ,-6.600791f ,-6.591203f ,-6.581482f ,-6.571634f ,-6.561661f ,-6.551570f ,-6.541363f ,-6.531045f ,-6.520619f ,-6.510091f ,-6.499462f ,-6.488737f ,-6.477920f ,-6.467013f ,-6.456020f ,-6.444944f ,-6.433787f ,-6.422554f ,-6.411246f ,-6.399867f ,-6.388419f ,-6.376905f ,-6.365327f ,-6.353688f ,-6.341990f ,-6.330236f ,-6.318428f ,-6.306567f ,-6.294657f ,-6.282699f ,-6.270696f ,-6.258649f ,-6.246561f ,-6.234433f ,-6.222267f ,-6.210065f ,-6.197829f ,-6.185560f ,-6.173261f ,-6.160932f ,-6.148577f ,-6.136195f ,-6.123790f ,-6.111362f ,-6.098912f ,-6.086443f ,-6.073956f ,-6.061453f ,-6.048934f ,-6.036401f ,-6.023855f ,-6.011298f ,-5.998732f ,-5.986157f ,-5.973574f ,-5.960986f ,-5.948392f ,-5.935795f ,-5.923195f ,-5.910594f ,-5.897992f ,-5.885392f ,-5.872793f ,-5.860197f ,-5.847605f ,-5.835018f ,-5.822437f ,-5.809864f ,-5.797298f ,-5.784741f ,-5.772194f ,-5.759657f ,-5.747133f ,-5.734621f ,-5.722122f ,-5.709638f ,-5.697168f ,-5.684715f ,-5.672278f ,-5.659858f ,-5.647457f ,-5.635075f ,-5.622712f ,-5.610369f ,-5.598048f ,-5.585748f ,-5.573470f ,-5.561215f ,-5.548984f ,-5.536776f ,-5.524593f ,-5.512435f ,-5.500303f ,-5.488197f ,-5.476117f ,-5.464064f ,-5.452039f ,-5.440041f ,-5.428072f ,-5.416131f ,-5.404217f ,-5.392331f ,-5.380473f ,-5.368643f ,-5.356842f ,-5.345070f ,-5.333328f ,-5.321615f ,-5.309932f ,-5.298278f ,-5.286654f ,-5.275059f ,-5.263493f ,-5.251957f ,-5.240450f ,-5.228972f ,-5.217522f ,-5.206101f ,-5.194707f ,-5.183339f ,-5.171998f ,-5.160682f ,-5.149388f ,-5.138117f ,-5.126866f ,-5.115634f ,-5.104419f ,-5.093219f ,-5.082034f ,-5.070862f ,-5.059702f ,-5.048552f ,-5.037413f ,-5.026283f ,-5.015161f ,-5.004048f ,-4.992943f ,-4.981845f ,-4.970755f ,-4.959673f ,-4.948598f ,-4.937531f ,-4.926472f ,-4.915420f ,-4.904376f ,-4.893340f },{8.000000f ,8.000000f ,7.999584f ,7.999382f ,7.999822f ,8.001289f ,8.004141f ,8.008708f ,8.015298f ,8.024198f ,8.035674f ,8.049975f ,8.067329f ,8.087949f ,8.112030f ,8.139752f ,8.171277f ,8.206756f ,8.246322f ,8.290096f ,8.338187f ,8.390688f ,8.447683f ,8.509240f ,8.575419f ,8.646266f ,8.721820f ,8.802107f ,8.887144f ,8.976939f ,9.071491f ,9.170790f ,9.274819f ,9.383552f ,9.496956f ,9.614991f ,9.737610f ,9.864760f ,9.996382f ,10.132410f ,10.272773f ,10.417395f ,10.566195f ,10.719088f ,10.875982f ,11.036783f ,11.201392f ,11.369708f ,11.541624f ,11.717030f ,11.895814f ,12.077861f ,12.263052f ,12.451266f ,12.642379f ,12.836269f ,13.032814f ,13.231894f ,13.433389f ,13.637181f ,13.843156f ,14.051197f ,14.261192f ,14.473029f ,14.686599f ,14.901792f ,15.118504f ,15.336628f ,15.556063f ,15.776706f ,15.998459f ,16.221225f ,16.444907f ,16.669412f ,16.894650f ,17.120530f ,17.346964f ,17.573868f ,17.801157f ,18.028751f ,18.256569f ,18.484536f ,18.712574f ,18.940611f ,19.168574f ,19.396392f ,19.623997f ,19.851322f ,20.078301f ,20.304871f ,20.530971f ,20.756541f ,20.981523f ,21.205860f ,21.429500f ,21.652387f ,21.874472f ,22.095704f ,22.316038f ,22.535425f ,22.753824f ,22.971189f ,23.187482f ,23.402662f ,23.616691f ,23.829534f ,24.041156f ,24.251524f ,24.460607f ,24.668375f ,24.874800f ,25.079855f ,25.283515f ,25.485756f ,25.686555f ,25.885891f ,26.083745f ,26.280097f ,26.474931f ,26.668231f ,26.859982f ,27.050172f ,27.238789f ,27.425822f ,27.611260f ,27.795097f ,27.977326f ,28.157939f ,28.336933f ,28.514303f ,28.690048f ,28.864165f ,29.036653f ,29.207512f ,29.376745f ,29.544352f ,29.710337f ,29.874703f ,30.037455f ,30.198598f ,30.358138f ,30.516083f ,30.672440f ,30.827218f ,30.980426f ,31.132074f ,31.282174f ,31.430736f ,31.577772f ,31.723295f ,31.867319f ,32.009858f ,32.150925f ,32.290536f ,32.428707f ,32.565454f ,32.700792f ,32.834740f ,32.967315f ,33.098535f ,33.228418f ,33.356982f ,33.484248f ,33.610235f ,33.734962f ,33.858449f ,33.980716f ,34.101784f ,34.221672f ,34.340402f ,34.457995f ,34.574474f ,34.689858f ,34.804171f ,34.917434f ,35.029669f ,35.140898f ,35.251142f ,35.360426f ,35.468769f ,35.576196f ,35.682726f ,35.788382f ,35.893184f ,35.997154f ,36.100313f ,36.202684f ,36.304288f ,36.405146f ,36.505280f ,36.604710f ,36.703457f ,36.801542f ,36.898985f ,36.995806f ,37.092024f ,37.187659f ,37.282730f ,37.377254f ,37.471250f ,37.564736f ,37.657729f ,37.750245f ,37.842301f ,37.933913f ,38.025097f ,38.115866f ,38.206237f ,38.296224f ,38.385840f ,38.475099f ,38.564014f ,38.652598f ,38.740862f ,38.828819f ,38.916482f ,39.003860f ,39.090967f ,39.177813f ,39.264409f ,39.350765f ,39.436892f ,39.522800f ,39.608498f ,39.693995f ,39.779300f ,39.864424f ,39.949375f ,40.034161f ,40.118792f ,40.203274f ,40.287616f ,40.371826f ,40.455910f ,40.539876f ,40.623732f ,40.707485f ,40.791141f ,40.874707f ,40.958190f ,41.041596f ,41.124931f ,41.208202f ,41.291414f ,41.374572f ,41.457683f ,41.540751f ,41.623783f ,41.706782f ,41.789752f ,41.872699f ,41.955626f ,42.038538f ,42.121440f ,42.204335f ,42.287227f ,42.370119f ,42.453016f ,42.535920f ,42.618835f ,42.701764f ,42.784711f ,42.867679f ,42.950670f ,43.033688f ,43.116735f ,43.199814f ,43.282926f ,43.366076f ,43.449264f ,43.532492f ,43.615761f ,43.699073f ,43.782430f ,43.865833f ,43.949285f ,44.032785f ,44.116336f ,44.199938f ,44.283593f ,44.367302f ,44.451065f ,44.534882f ,44.618755f ,44.702683f ,44.786669f ,44.870711f ,44.954810f ,45.038967f ,45.123182f ,45.207454f ,45.291785f ,45.376174f ,45.460620f ,45.545124f ,45.629686f ,45.714304f ,45.798978f ,45.883708f ,45.968493f ,46.053333f ,46.138227f ,46.223174f ,46.308174f ,46.393225f ,46.478326f ,46.563476f ,46.648674f ,46.733918f ,46.819208f ,46.904542f ,46.989919f ,47.075338f ,47.160796f ,47.246293f ,47.331827f ,47.417396f ,47.503000f ,47.588635f ,47.674301f ,47.759996f ,47.845718f ,47.931465f ,48.017236f ,48.103028f ,48.188840f ,48.274670f ,48.360516f ,48.446377f ,48.532249f ,48.618131f ,48.704022f ,48.789920f ,48.875821f ,48.961725f ,49.047628f ,49.133530f ,49.219429f ,49.305321f ,49.391206f ,49.477082f ,49.562946f ,49.648798f ,49.734635f ,49.820456f ,49.906260f ,49.992046f ,50.077813f ,50.163562f ,50.249293f ,50.335007f ,50.420711f ,50.506425f ,50.592179f ,50.678006f ,50.763937f ,50.850003f ,50.936236f ,51.022665f ,51.109320f ,51.196232f ,51.283429f ,51.370941f ,51.458796f ,51.547021f ,51.635643f ,51.724689f ,51.814184f ,51.904150f ,51.994612f ,52.085591f ,52.177109f ,52.269183f ,52.361834f ,52.455077f ,52.548931f ,52.643408f ,52.738523f ,52.834286f ,52.930705f ,53.027789f ,53.125541f ,53.223966f ,53.323064f ,53.422832f ,53.523268f ,53.624367f ,53.726125f ,53.828535f ,53.931588f ,54.035277f ,54.139592f ,54.244524f ,54.350060f ,54.456189f ,54.562901f ,54.670185f ,54.778029f ,54.886424f ,54.995357f ,55.104816f ,55.214789f ,55.325267f ,55.436240f ,55.547696f ,55.659631f ,55.772046f ,55.884942f ,55.998323f ,56.112188f ,56.226543f ,56.341393f ,56.456747f ,56.572609f ,56.688989f ,56.805899f ,56.923344f ,57.041336f ,57.159881f ,57.278990f ,57.398671f ,57.518934f ,57.639790f ,57.761249f ,57.883322f ,58.006018f ,58.129349f ,58.253324f ,58.377957f ,58.503256f ,58.629225f ,58.755860f ,58.883156f ,59.011107f ,59.139704f ,59.268940f ,59.398807f ,59.529297f ,59.660399f ,59.792105f ,59.924397f ,60.057262f ,60.190689f ,60.324661f ,60.459163f ,60.594178f ,60.729690f ,60.865686f ,61.002149f ,61.139062f ,61.276410f ,61.414175f ,61.552338f ,61.690884f ,61.829795f ,61.969053f ,62.108640f ,62.248539f ,62.388729f ,62.529192f ,62.669907f ,62.810854f ,62.952013f ,63.093369f ,63.234908f ,63.376615f ,63.518481f ,63.660500f ,63.802662f ,63.944948f ,64.087352f ,64.229868f ,64.372486f ,64.515199f ,64.657993f ,64.800853f ,64.943761f ,65.086705f ,65.229704f ,65.372753f ,65.515834f ,65.658932f ,65.802053f ,65.945185f ,66.088326f ,66.231460f ,66.374591f ,66.517749f ,66.660919f ,66.804090f ,66.947252f ,67.090418f ,67.233574f ,67.376715f ,67.519838f ,67.662970f ,67.806108f ,67.949238f ,68.092367f ,68.235494f ,68.378600f ,68.521683f ,68.664752f ,68.807810f ,68.950850f ,69.093857f ,69.236804f ,69.379671f ,69.522431f ,69.665058f ,69.807535f ,69.949845f ,70.092047f ,70.234122f ,70.376052f ,70.517811f ,70.659377f ,70.800726f ,70.941837f ,71.082694f ,71.223306f ,71.363685f ,71.503812f ,71.643675f ,71.783253f ,71.922523f ,72.061464f ,72.200054f ,72.338272f ,72.476098f ,72.613513f ,72.750499f ,72.887038f ,73.023123f ,73.158741f ,73.293883f ,73.428543f ,73.562719f ,73.696425f ,73.829714f ,73.962621f ,74.095151f ,74.227300f ,74.359061f ,74.490428f ,74.621392f ,74.751945f ,74.882075f ,75.011773f ,75.141031f ,75.269838f ,75.398185f ,75.526063f ,75.653460f ,75.780365f ,75.906769f ,76.032665f ,76.158049f ,76.282914f ,76.407253f ,76.531059f ,76.654327f ,76.777055f ,76.899237f ,77.020872f ,77.141952f ,77.262476f ,77.382438f ,77.501836f ,77.620667f ,77.738929f ,77.856618f ,77.973734f ,78.090277f ,78.206243f ,78.321632f ,78.436446f ,78.550686f ,78.664353f ,78.777448f ,78.889981f ,79.001952f ,79.113372f ,79.224247f ,79.334583f ,79.444385f ,79.553661f ,79.662412f ,79.770653f ,79.878391f ,79.985633f ,80.092394f ,80.198689f ,80.304534f ,80.409942f ,80.514948f ,80.619561f ,80.723788f ,80.827659f ,80.931259f ,81.034655f ,81.137911f ,81.241103f ,81.344292f ,81.447497f ,81.550727f ,81.653969f ,81.757210f ,81.860497f ,81.963836f ,82.067236f ,82.170682f ,82.274214f ,82.377830f ,82.481591f ,82.585519f ,82.689716f ,82.794233f ,82.899037f ,83.004209f ,83.109713f ,83.215620f ,83.322041f ,83.428940f ,83.536240f ,83.643854f ,83.751693f ,83.859667f ,83.967689f ,84.075671f ,84.183533f ,84.291194f ,84.398577f ,84.505609f ,84.612221f ,84.718347f ,84.823922f ,84.928888f ,85.033186f ,85.136764f ,85.239571f ,85.341559f ,85.442683f ,85.542901f ,85.642173f ,85.740462f ,85.837733f ,85.933955f ,86.029096f ,86.123130f ,86.216029f ,86.307772f ,86.398335f ,86.487699f ,86.575845f ,86.662757f ,86.748421f ,86.832822f ,86.915949f ,86.997792f ,87.078341f ,87.157588f ,87.235529f ,87.312156f ,87.387466f ,87.461456f ,87.534125f ,87.605470f ,87.675493f ,87.744194f ,87.811575f ,87.877638f ,87.942388f ,88.005829f ,88.067965f ,88.128803f ,88.188349f ,88.246610f ,88.303594f ,88.359309f ,88.413764f ,88.466969f ,88.518933f ,88.569667f ,88.619182f ,88.667490f ,88.714602f ,88.760531f ,88.805290f ,88.848891f ,88.891348f ,88.932675f ,88.972886f ,89.011996f ,89.050020f ,89.086973f ,89.122870f ,89.157727f ,89.191560f ,89.224385f ,89.256220f ,89.287080f ,89.316983f ,89.345946f ,89.373986f ,89.401121f ,89.427367f ,89.452742f ,89.477261f ,89.500941f ,89.523795f ,89.545840f ,89.567091f ,89.587562f ,89.607267f ,89.626221f ,89.644438f ,89.661932f ,89.678718f ,89.694810f ,89.710221f ,89.724967f ,89.739060f ,89.752516f ,89.765349f ,89.777573f ,89.789203f ,89.800253f ,89.810739f ,89.820674f ,89.830074f ,89.838953f ,89.847327f ,89.855212f ,89.862621f ,89.869571f ,89.876077f ,89.882154f ,89.887818f ,89.893085f ,89.897969f ,89.902487f ,89.906655f ,89.910487f ,89.913999f ,89.917207f ,89.920126f ,89.922772f ,89.925160f ,89.927304f ,89.929220f ,89.930922f ,89.932426f ,89.933744f ,89.934891f ,89.935882f ,89.936731f ,89.937451f ,89.938056f ,89.938558f ,89.938970f ,89.939303f ,89.939567f ,89.939774f ,89.939932f ,89.940052f ,89.940141f ,89.940206f ,89.940256f ,89.940294f ,89.940328f ,89.940359f ,89.940392f ,89.940428f ,89.940470f ,89.940516f ,89.940568f ,89.940625f ,89.940687f ,89.940753f ,89.940823f ,89.940897f ,89.940974f ,89.941053f ,89.941135f ,89.941218f ,89.941303f ,89.941388f ,89.941474f ,89.941559f ,89.941644f ,89.941727f ,89.941808f ,89.941888f ,89.941967f ,89.942044f ,89.942119f ,89.942193f ,89.942266f ,89.942337f },{0.150295f ,0.160062f ,0.163121f ,0.165020f ,0.166330f ,0.167284f ,0.168057f ,0.168680f ,0.169184f ,0.169588f ,0.169904f ,0.170142f ,0.170308f ,0.170406f ,0.170440f ,0.170413f ,0.170327f ,0.170185f ,0.169987f ,0.169736f ,0.169432f ,0.169077f ,0.168672f ,0.168217f ,0.167713f ,0.167160f ,0.166560f ,0.165913f ,0.165219f ,0.164477f ,0.163689f ,0.162854f ,0.161971f ,0.161041f ,0.160063f ,0.159036f ,0.157959f ,0.156831f ,0.155652f ,0.154419f ,0.153131f ,0.151786f ,0.150382f ,0.148917f ,0.147389f ,0.145795f ,0.144132f ,0.142397f ,0.140587f ,0.138698f ,0.136726f ,0.134668f ,0.132529f ,0.130463f ,0.128515f ,0.126681f ,0.124954f ,0.123329f ,0.121801f ,0.120364f ,0.119015f ,0.117748f ,0.116558f ,0.115443f ,0.114398f ,0.113419f ,0.112503f ,0.111646f ,0.110845f ,0.110097f ,0.109399f ,0.108748f ,0.108142f ,0.107577f ,0.107053f ,0.106566f ,0.106114f ,0.105695f ,0.105307f ,0.104950f ,0.104619f ,0.104315f ,0.104036f ,0.103779f ,0.103544f ,0.103329f ,0.103133f ,0.102954f ,0.102792f ,0.102645f ,0.102513f ,0.102393f ,0.102286f ,0.102190f ,0.102104f ,0.102028f ,0.101961f ,0.101901f ,0.101849f ,0.101804f ,0.101764f ,0.101730f ,0.101700f ,0.101675f ,0.101653f ,0.101635f ,0.101619f ,0.101605f ,0.101593f ,0.101582f ,0.101573f ,0.101564f ,0.101555f ,0.101546f ,0.101536f ,0.101526f ,0.101514f ,0.101502f ,0.101487f ,0.101471f ,0.101452f ,0.101432f ,0.101408f ,0.101383f ,0.101356f ,0.101327f ,0.101298f ,0.101265f ,0.101226f ,0.101178f ,0.101122f ,0.101058f ,0.100985f ,0.100906f ,0.100820f ,0.100727f ,0.100627f ,0.100520f ,0.100407f ,0.100287f ,0.100161f ,0.100028f ,0.099889f ,0.099744f ,0.099592f ,0.099433f ,0.099268f ,0.099097f ,0.098919f ,0.098736f ,0.098545f ,0.098349f ,0.098147f ,0.097938f ,0.097723f ,0.097503f ,0.097276f ,0.097044f ,0.096806f ,0.096562f ,0.096313f ,0.096059f ,0.095799f ,0.095534f ,0.095264f ,0.094989f ,0.094709f ,0.094425f ,0.094137f ,0.093844f ,0.093547f ,0.093247f ,0.092943f ,0.092635f ,0.092324f ,0.092011f ,0.091695f ,0.091376f ,0.091056f ,0.090733f ,0.090410f ,0.090085f ,0.089759f ,0.089433f ,0.089108f ,0.088782f ,0.088458f ,0.088135f ,0.087814f ,0.087495f ,0.087179f ,0.086867f ,0.086559f ,0.086256f ,0.085958f ,0.085667f ,0.085383f ,0.085106f ,0.084838f ,0.084579f ,0.084330f ,0.084090f ,0.083859f ,0.083637f ,0.083425f ,0.083220f ,0.083024f ,0.082835f ,0.082653f ,0.082477f ,0.082307f ,0.082143f ,0.081984f ,0.081831f ,0.081681f ,0.081537f ,0.081396f ,0.081259f ,0.081125f ,0.080995f ,0.080868f ,0.080744f ,0.080623f ,0.080504f ,0.080388f ,0.080274f ,0.080161f ,0.080051f ,0.079942f ,0.079835f ,0.079729f ,0.079625f ,0.079521f ,0.079419f ,0.079318f ,0.079218f ,0.079119f ,0.079021f ,0.078923f ,0.078827f ,0.078730f ,0.078635f ,0.078540f ,0.078445f ,0.078351f ,0.078258f ,0.078165f ,0.078072f ,0.077979f ,0.077887f ,0.077795f ,0.077703f ,0.077612f ,0.077520f ,0.077429f ,0.077338f ,0.077247f ,0.077155f ,0.077064f ,0.076973f ,0.076882f ,0.076792f ,0.076701f ,0.076610f ,0.076519f ,0.076428f ,0.076337f ,0.076246f ,0.076155f ,0.076064f ,0.075973f ,0.075882f ,0.075792f ,0.075702f ,0.075611f ,0.075520f ,0.075430f ,0.075339f ,0.075249f ,0.075158f ,0.075068f ,0.074977f ,0.074886f ,0.074795f ,0.074704f ,0.074614f ,0.074523f ,0.074432f ,0.074341f ,0.074250f ,0.074159f ,0.074069f ,0.073978f ,0.073887f ,0.073797f ,0.073707f ,0.073618f ,0.073529f ,0.073440f ,0.073351f ,0.073262f ,0.073174f ,0.073086f ,0.072999f ,0.072912f ,0.072825f ,0.072739f ,0.072653f ,0.072567f ,0.072482f ,0.072397f ,0.072313f ,0.072230f ,0.072148f ,0.072066f ,0.071985f ,0.071906f ,0.071827f ,0.071750f ,0.071673f ,0.071597f ,0.071523f ,0.071450f ,0.071378f ,0.071308f ,0.071240f ,0.071173f ,0.071108f ,0.071046f ,0.070985f ,0.070927f ,0.070872f ,0.070821f ,0.070772f ,0.070727f ,0.070687f ,0.070651f ,0.070621f ,0.070597f ,0.070581f ,0.070574f ,0.070577f ,0.070593f ,0.070625f ,0.070678f ,0.070758f ,0.070875f ,0.071047f ,0.071308f ,0.071747f ,0.073295f ,0.075292f ,0.077488f ,0.079740f ,0.082000f ,0.084217f ,0.086457f ,0.088752f ,0.091079f ,0.093343f ,0.095669f ,0.098009f ,0.100324f ,0.102615f ,0.104939f ,0.107185f ,0.109428f ,0.111636f ,0.113840f ,0.115975f ,0.118076f ,0.120160f ,0.122187f ,0.124198f ,0.126105f ,0.127956f ,0.129743f ,0.131375f ,0.132925f ,0.134429f ,0.135766f ,0.136983f ,0.138075f ,0.139092f ,0.140050f ,0.141007f ,0.141843f ,0.142567f ,0.143404f ,0.144029f ,0.144743f ,0.145261f ,0.145845f ,0.146531f ,0.147084f ,0.147713f ,0.148422f ,0.148927f ,0.149468f ,0.150062f ,0.150761f ,0.151461f ,0.152037f ,0.153100f ,0.154513f ,0.155865f ,0.157410f ,0.158825f ,0.160410f ,0.162179f ,0.164102f ,0.165810f ,0.167803f ,0.169953f ,0.171794f ,0.173939f ,0.175894f ,0.177933f ,0.180033f ,0.182144f ,0.184385f ,0.186593f ,0.188872f ,0.191025f ,0.193396f ,0.195688f ,0.198186f ,0.200429f ,0.202274f ,0.203858f ,0.205282f ,0.206567f ,0.207782f ,0.209158f ,0.210362f ,0.211576f ,0.212718f ,0.213857f ,0.214584f ,0.215545f ,0.216479f ,0.217263f ,0.218020f ,0.218667f ,0.219432f ,0.220290f ,0.220928f ,0.221566f ,0.222293f ,0.222892f ,0.223335f ,0.224052f ,0.224531f ,0.225114f ,0.225550f ,0.226058f ,0.226386f ,0.226856f ,0.227016f ,0.227332f ,0.227656f ,0.228167f ,0.228789f ,0.229365f ,0.230162f ,0.231375f ,0.232113f ,0.232388f ,0.233379f ,0.234417f ,0.235258f ,0.236143f ,0.236705f ,0.237071f ,0.237350f ,0.237884f ,0.240364f ,0.241423f ,0.241589f ,0.241906f ,0.243682f ,0.244091f ,0.245201f ,0.245586f ,0.247011f ,0.250060f ,0.250406f ,0.250988f ,0.251573f ,0.253553f ,0.253944f ,0.254789f ,0.255743f ,0.258628f ,0.259642f ,0.259977f ,0.261489f ,0.262624f ,0.262616f ,0.263608f ,0.265311f ,0.266551f ,0.267295f ,0.267405f ,0.266938f ,0.266588f ,0.265989f ,0.265442f ,0.265272f ,0.265169f ,0.269788f ,0.269645f ,0.269390f ,0.268657f ,0.268317f ,0.267597f ,0.267119f ,0.267028f ,0.268312f ,0.269911f ,0.269569f ,0.269548f ,0.269007f ,0.268307f ,0.267782f ,0.267035f ,0.266455f ,0.265801f ,0.265310f ,0.264687f ,0.264266f ,0.264209f ,0.264102f ,0.263954f ,0.264156f ,0.264415f ,0.265832f ,0.269629f ,0.272268f ,0.273123f ,0.273406f ,0.273543f ,0.273564f ,0.273578f ,0.273502f ,0.273229f ,0.273130f ,0.273010f ,0.272726f ,0.272595f ,0.272399f ,0.271979f ,0.271686f ,0.271389f ,0.271270f ,0.271307f ,0.271187f ,0.270977f ,0.270792f ,0.270751f ,0.270756f ,0.270744f ,0.270707f ,0.270464f ,0.270576f ,0.270435f ,0.270294f ,0.270366f ,0.270360f ,0.270178f ,0.270307f ,0.270364f ,0.270293f ,0.270247f ,0.270539f ,0.270619f ,0.270752f ,0.270829f ,0.271458f ,0.271609f ,0.272227f ,0.272663f ,0.273088f ,0.273385f ,0.273930f ,0.274047f ,0.274946f ,0.275417f ,0.275911f ,0.276853f ,0.277771f ,0.278863f ,0.279680f ,0.281870f ,0.282558f ,0.283068f ,0.284947f ,0.290418f ,0.294649f ,0.298872f ,0.303873f ,0.307944f ,0.309532f ,0.310417f ,0.309894f ,0.309561f ,0.312704f ,0.313577f ,0.314444f ,0.313927f ,0.316783f ,0.317082f ,0.321241f ,0.323128f ,0.329883f ,0.333676f ,0.332145f ,0.337759f ,0.336148f ,0.341250f ,0.348673f ,0.347258f ,0.343163f ,0.338399f ,0.333402f ,0.328348f ,0.323324f ,0.318381f ,0.313548f ,0.308844f ,0.304280f ,0.299862f ,0.295594f ,0.291477f ,0.287510f ,0.283692f ,0.280020f ,0.276492f ,0.273103f ,0.269851f ,0.266731f ,0.263739f ,0.260871f ,0.258124f ,0.255492f ,0.252971f ,0.250559f ,0.248250f ,0.246041f ,0.243929f ,0.241909f ,0.239978f ,0.238133f ,0.236370f ,0.234686f ,0.233078f ,0.231543f ,0.230079f ,0.228682f ,0.227350f ,0.226081f ,0.224871f ,0.223719f ,0.222622f ,0.221578f ,0.220586f ,0.219643f ,0.218747f ,0.217897f ,0.217090f ,0.216326f ,0.215602f ,0.214918f ,0.214270f ,0.213660f ,0.213084f ,0.212542f ,0.212032f ,0.211554f ,0.211105f ,0.210686f ,0.210296f ,0.209932f ,0.209595f ,0.209283f ,0.208995f ,0.208731f ,0.208491f ,0.208272f ,0.208075f ,0.207899f ,0.207743f ,0.207606f ,0.207488f ,0.207389f ,0.207308f ,0.207243f ,0.207196f ,0.207165f ,0.207149f ,0.207149f ,0.207164f ,0.207193f ,0.207236f ,0.207293f ,0.207363f ,0.207446f ,0.207542f ,0.207649f ,0.207769f ,0.207900f ,0.208042f ,0.208195f ,0.208358f ,0.208532f ,0.208716f ,0.208909f ,0.209112f ,0.209324f ,0.209544f ,0.209774f ,0.210011f ,0.210257f ,0.210511f ,0.210772f ,0.211041f ,0.211317f ,0.211600f ,0.211890f ,0.212186f ,0.212488f ,0.212797f ,0.213112f ,0.213432f ,0.213758f ,0.214090f ,0.214427f ,0.214769f ,0.215116f ,0.215467f ,0.215824f ,0.216184f ,0.216550f ,0.216920f ,0.217294f ,0.217673f ,0.218055f ,0.218443f ,0.218835f ,0.219234f ,0.219639f ,0.220054f ,0.220474f ,0.220828f ,0.221186f ,0.221565f ,0.221960f ,0.222367f ,0.222782f ,0.223205f ,0.223635f ,0.224071f ,0.224512f ,0.224960f ,0.225413f ,0.225873f ,0.226339f ,0.226812f ,0.227291f ,0.227777f ,0.228267f ,0.228759f ,0.229246f ,0.229720f ,0.230171f ,0.230591f ,0.230973f ,0.231316f ,0.231618f ,0.231881f ,0.232108f ,0.232294f ,0.232450f ,0.232578f ,0.232681f ,0.232760f ,0.232820f ,0.232863f ,0.232894f ,0.232916f ,0.232931f ,0.232942f ,0.232949f ,0.232954f ,0.232957f ,0.232958f ,0.232958f ,0.232957f ,0.232954f ,0.232950f }};
Tailsitter::Tailsitter(VtolAttitudeControl *attc) :
	VtolType(attc),
	_thrust_transition_start(0.0f),
	_yaw_transition(0.0f),
	_pitch_transition_start(0.0f)
{
	_vtol_schedule.flight_mode = MC_MODE;
	_vtol_schedule.transition_start = 0;

	_mc_roll_weight = 1.0f;
	_mc_pitch_weight = 1.0f;
	_mc_yaw_weight = 1.0f;

	_flag_was_in_trans_mode = false;
	//xj-zhang
	_params_handles_tailsitter.front_trans_dur_p2 = param_find("VT_TRANS_P2_DUR");
	_params_handles_tailsitter.trans_thr_min = param_find("ZXJ_TRAN_THR_MIN");
	_params_handles_tailsitter.trans_thr_max = param_find("ZXJ_TRAN_THR_MAX");
	_params_handles_tailsitter.fw_pitch_trim = param_find("ZXJ_FWPITCH_TRIM");
	_params_handles_tailsitter.GROUND_SPEED2_TRANSITION_FRONT_P1 = param_find("ZXJ_TRANP1_GSPE");
	_params_handles_tailsitter.manual_pitch_max=param_find("ZXJ_MAN_PIT_MAX");
	_params_handles_tailsitter.manual_roll_max=param_find("ZXJ_MAN_ROL_MAX");
	_params_handles_tailsitter.manual_yaw_max=param_find("ZXJ_MAN_YAW_MAX");
	_params_handles_tailsitter.trans_f_p2_dur=param_find("ZXJ_TRA_F_P2_DUR");
	_params_handles_tailsitter.trans_b_p2_dur=param_find("ZXJ_TRA_B_P2_DUR");
	_params_handles_tailsitter.trans_p3_dur=param_find("ZXJ_TRAN_P3_DUR");
	_params_handles_tailsitter.trans_p3_f_pitch=param_find("ZXJ_TRP3_F_PIT");
	_params_handles_tailsitter.yaw_control_flag=param_find("ZXJ_TRA_YAW_FLA");
	_params_handles_tailsitter.height_p=param_find("ZXJ_THR_HEI_P");
	_manual=_attc->get_manual_control_sp();

}

void
Tailsitter::parameters_update()
{
	float v;
	int32_t v2;
	/* vtol front transition phase 2 duration */
	//xj-zhang
	param_get(_params_handles_tailsitter.front_trans_dur_p2, &v);
	_params_tailsitter.front_trans_dur_p2 = v;
	param_get(_params_handles_tailsitter.trans_thr_min, &v);
	_params_tailsitter.trans_thr_min = v;
	param_get(_params_handles_tailsitter.trans_thr_max, &v);
	_params_tailsitter.trans_thr_max = v;
	param_get(_params_handles_tailsitter.fw_pitch_trim, &v);
	_params_tailsitter.fw_pitch_trim=v;
	param_get(_params_handles_tailsitter.GROUND_SPEED2_TRANSITION_FRONT_P1, &v);
	_params_tailsitter.GROUND_SPEED2_TRANSITION_FRONT_P1 = v;
	param_get(_params_handles_tailsitter.manual_pitch_max, &v);
	_params_tailsitter.manual_pitch_max = v;
	param_get(_params_handles_tailsitter.manual_roll_max, &v);
	_params_tailsitter.manual_roll_max = v;
	param_get(_params_handles_tailsitter.manual_yaw_max, &v);
	_params_tailsitter.manual_yaw_max = v;
	param_get(_params_handles_tailsitter.trans_f_p2_dur, &v);
	_params_tailsitter.trans_f_p2_dur = v;
	param_get(_params_handles_tailsitter.trans_b_p2_dur, &v);
	_params_tailsitter.trans_b_p2_dur = v;
	param_get(_params_handles_tailsitter.trans_p3_dur, &v);
	_params_tailsitter.trans_p3_dur = v;
	param_get(_params_handles_tailsitter.trans_p3_f_pitch, &v);
	_params_tailsitter.trans_p3_f_pitch = v;
	param_get(_params_handles_tailsitter.yaw_control_flag, &v2);
	_params_tailsitter.yaw_control_flag= (v2==1);
	param_get(_params_handles_tailsitter.height_p, &v);
	_params_tailsitter.height_p = v;
}

void Tailsitter::update_vtol_state()
{

	/* simple logic using a two way switch to perform transitions.
	 * after flipping the switch the vehicle will start tilting in MC control mode, picking up
	 * forward speed. After the vehicle has picked up enough and sufficient pitch angle the uav will go into FW mode.
	 * For the backtransition the pitch is controlled in MC mode again and switches to full MC control reaching the sufficient pitch angle.
	*/

	matrix::Eulerf euler = matrix::Quatf(_v_att->q);
	float pitch = euler.theta();

	if (!_attc->is_fixed_wing_requested()) {

		switch (_vtol_schedule.flight_mode) { // user switchig to MC mode
		case MC_MODE:
			break;

		case FW_MODE:
			_vtol_schedule.flight_mode 	= TRANSITION_BACK_P1;
			_vtol_schedule.transition_start = hrt_absolute_time();
			break;

		case TRANSITION_FRONT_P1:
			// failsafe into multicopter mode
			_vtol_schedule.flight_mode = MC_MODE;
			break;
		case TRANSITION_FRONT_P2:
			// failsafe into multicopter mode
			_vtol_schedule.flight_mode = TRANSITION_BACK_P1;
			_vtol_schedule.transition_start = hrt_absolute_time();
			break;
		case TRANSITION_FRONT_P3:
			// failsafe into multicopter mode
			_vtol_schedule.flight_mode = TRANSITION_BACK_P1;
			_vtol_schedule.transition_start = hrt_absolute_time();
			break;
		case TRANSITION_BACK_P1: {
			// check if we have reached pitch angle to switch to MC mode
			/*if (pitch >= PITCH_TRANSITION_BACK_P1) {
				_vtol_schedule.flight_mode = TRANSITION_BACK_P2;
				_time_transition_start_p2=hrt_absolute_time();
			}*/
			float ground_speed_2=_local_pos->vx*_local_pos->vx+_local_pos->vy*_local_pos->vy;
			float time_duration = (hrt_absolute_time() - _vtol_schedule.transition_start)* 1e-6f;
			if ((time_duration > 1.95f && ground_speed_2 < 4.0f) || time_duration > 3.5f) {
				_vtol_schedule.flight_mode = MC_MODE;
			}
			break;
		}
		case TRANSITION_BACK_P2:
			// check if we have reached pitch angle to switch to MC mode
			if (pitch >= PITCH_TRANSITION_BACK_P2) {
				_vtol_schedule.flight_mode = TRANSITION_BACK_P3;
				_time_transition_start_p3=hrt_absolute_time();
			}
			break;
		case TRANSITION_BACK_P3:
			// check if we have reached pitch angle to switch to MC mode
			//xj-zhang P3 keep attitude
			if (((hrt_absolute_time()-_time_transition_start_p3)* 1e-6f) >= _params_tailsitter.trans_p3_dur) {
				_vtol_schedule.flight_mode = MC_MODE;
			}
			break;
		}

	} else {  // user switchig to FW mode

		switch (_vtol_schedule.flight_mode) {
		case MC_MODE:
			// initialise a front transition
			_vtol_schedule.flight_mode 	= TRANSITION_FRONT_P1;
			_vtol_schedule.transition_start = hrt_absolute_time();
			break;

		case FW_MODE:
			break;
			//xj-zhang
		case TRANSITION_FRONT_P1: {
			// check if we have reached ground speed  and pitch angle to switch to TRANSITION P2 mode
				/*float ground_speed_2=_local_pos->vx*_local_pos->vx+_local_pos->vy*_local_pos->vy;
				if ((ground_speed_2 >  _params_tailsitter.GROUND_SPEED2_TRANSITION_FRONT_P1 && pitch <= PITCH_TRANSITION_FRONT_P1) || can_transition_on_ground()) {
					_vtol_schedule.flight_mode = TRANSITION_FRONT_P2;
					_time_transition_start_p2=hrt_absolute_time();
				}*/
			    float time_duration = (hrt_absolute_time() - _vtol_schedule.transition_start)* 1e-6f;
			    if (time_duration > 1.95f) {
			    	_vtol_schedule.flight_mode = FW_MODE;
			    }
				break;
		}
		case TRANSITION_FRONT_P2: {

				bool airspeed_condition_satisfied = _airspeed->indicated_airspeed_m_s >= _params->transition_airspeed;
				airspeed_condition_satisfied |= _params->airspeed_disabled;

				// check if we have reached airspeed  and pitch angle to switch to TRANSITION P2 mode
				if ((pitch <= PITCH_TRANSITION_FRONT_P2)) {
					_vtol_schedule.flight_mode = TRANSITION_FRONT_P3;
					_time_transition_start_p3=hrt_absolute_time();
				}

				break;
			}
		case TRANSITION_FRONT_P3: {
			//xj-zhang P3 keep attitude
			if (((hrt_absolute_time()-_time_transition_start_p3)* 1e-6f) >= _params_tailsitter.trans_p3_dur) {
				_vtol_schedule.flight_mode = FW_MODE;
			}
			break;
		}
		case TRANSITION_BACK_P1:
			// failsafe into fixed wing mode
			_vtol_schedule.flight_mode = FW_MODE;
			break;
		case TRANSITION_BACK_P2:
			// failsafe into fixed wing mode
			//_vtol_schedule.flight_mode = FW_MODE;
			_vtol_schedule.flight_mode 	= TRANSITION_FRONT_P1;
			_vtol_schedule.transition_start = hrt_absolute_time();
			break;
		case TRANSITION_BACK_P3:
			// failsafe into fixed wing mode
			_vtol_schedule.flight_mode 	= TRANSITION_FRONT_P1;
			_vtol_schedule.transition_start = hrt_absolute_time();
			break;
		}
	}

	// map tailsitter specific control phases to simple control modes
	switch (_vtol_schedule.flight_mode) {
	case MC_MODE:
		_vtol_mode = ROTARY_WING;
		_vtol_vehicle_status->vtol_in_trans_mode = false;
		_flag_was_in_trans_mode = false;
		break;

	case FW_MODE:
		_vtol_mode = FIXED_WING;
		_vtol_vehicle_status->vtol_in_trans_mode = false;
		_vtol_vehicle_status->vtol_trans_in_P1=false;
		_flag_was_in_trans_mode = false;
		break;

	case TRANSITION_FRONT_P1:
		_vtol_mode = TRANSITION_TO_FW;
		_vtol_vehicle_status->vtol_in_trans_mode = true;
		_vtol_vehicle_status->vtol_trans_in_P1=true;
		break;
	case TRANSITION_FRONT_P2:
		_vtol_mode = TRANSITION_TO_FW;
		_vtol_vehicle_status->vtol_in_trans_mode = true;
		_vtol_vehicle_status->vtol_trans_in_P1=false;
		break;
	case TRANSITION_FRONT_P3:
		_vtol_mode = TRANSITION_TO_FW;
		_vtol_vehicle_status->vtol_in_trans_mode = true;
		_vtol_vehicle_status->vtol_trans_in_P1=false;
		break;
	case TRANSITION_BACK_P1:
		_vtol_mode = TRANSITION_TO_MC;
		_vtol_vehicle_status->vtol_in_trans_mode = true;
		_vtol_vehicle_status->vtol_trans_in_P1=true;
		break;
	case TRANSITION_BACK_P2:
		_vtol_mode = TRANSITION_TO_MC;
		_vtol_vehicle_status->vtol_in_trans_mode = true;
		_vtol_vehicle_status->vtol_trans_in_P1=false;
		break;
	case TRANSITION_BACK_P3:
		_vtol_mode = TRANSITION_TO_MC;
		_vtol_vehicle_status->vtol_in_trans_mode = true;
		_vtol_vehicle_status->vtol_trans_in_P1=false;
		break;
	}
}

void Tailsitter::update_transition_state()
{
	float time_since_trans_start = (float)(hrt_absolute_time() - _vtol_schedule.transition_start) * 1e-6f;
	matrix::Eulerf euler = matrix::Quatf(_v_att->q);
	if (!_flag_was_in_trans_mode) {
		// save desired heading for transition and last thrust value
		_yaw_transition = _v_att_sp->yaw_body;
		//transition should start from current attitude instead of current setpoint
		_pitch_transition_start = euler.theta();
		_thrust_transition_start = _v_att_sp->thrust;
		_z_start=_local_pos->z;
		_flag_was_in_trans_mode = true;
	}
	//xj-zhang
	if (_vtol_schedule.flight_mode == TRANSITION_FRONT_P1) {
		//float weight=(euler.theta())/fabsf(PITCH_TRANSITION_FRONT_P1);
		// in the first stage,set the pitch angle to the transition angle and keep it until the ground speed larger that the threshold
		/*_v_att_sp->pitch_body = _pitch_transition_start	- fabsf(PITCH_TRANSITION_FRONT_P1 - _pitch_transition_start) *
							time_since_trans_start/_params->front_trans_duration;
		_v_att_sp->pitch_body = math::constrain(_v_att_sp->pitch_body, PITCH_TRANSITION_FRONT_P1-0.1f,
									_pitch_transition_start);
		// disable mc yaw control once the plane has picked up speed
		_mc_yaw_weight = 1.0f-weight;
		_mc_roll_weight = _mc_pitch_weight=1.0f;
		_pitch_transition_start_p2= euler.theta();
		_v_att_sp->thrust = _mc_virtual_att_sp->thrust;
		_thrust_transition_start=_v_att_sp->thrust;
		_munual_thr_start=_manual->z;*/
		int rk = int((hrt_absolute_time() - _vtol_schedule.transition_start)* 4e-4f);//1e-6f;
		//float weight = (hrt_absolute_time() - _vtol_schedule.transition_start)*1e-6f/3.0f;
		_v_att_sp->pitch_body = state_front[1][rk] / 57.3f - 1.57f;
		//_v_att_sp->thrust = _mc_virtual_att_sp->thrust + 0.8f * (_local_pos->vz - state_front[0][rk]);
		_v_att_sp->thrust = state_front[2][rk] + 1.0f * (_local_pos->vz - state_front[0][rk]);
		if (euler.theta() > -0.785f) {
			_mc_yaw_weight = 1.0f;//1.0f - weight;
			_mc_roll_weight = 1.0f;//1.0f - weight;
		}
		else {
			_mc_yaw_weight = 0.0f;//1.0f - weight;
			_mc_roll_weight = 0.0f;//1.0f - weight;
		}

		_mc_pitch_weight = 0.5;
	}else if (_vtol_schedule.flight_mode == TRANSITION_FRONT_P2) {
		float scale=(hrt_absolute_time()-_time_transition_start_p2)*1e-6f/ (_params_tailsitter.trans_f_p2_dur);
		float H=_params_tailsitter.trans_thr_max-_thrust_transition_start;
		float weight=fabsf((euler.theta()-_pitch_transition_start_p2)/(PITCH_TRANSITION_FRONT_P2 - _pitch_transition_start_p2));
		// create time dependant pitch angle set point + 0.2 rad overlap over the switch value
		//使用二次函数设定俯仰角
		if(scale>1)
			scale=1;
		_v_att_sp->pitch_body =(_pitch_transition_start_p2-PITCH_TRANSITION_FRONT_P2)*(1-scale)*(1-scale)+PITCH_TRANSITION_FRONT_P2;// _pitch_transition_start_p2- fabsf(PITCH_TRANSITION_FRONT_P2 - _pitch_transition_start_p2) *scale;
		_v_att_sp->pitch_body = math::constrain(_v_att_sp->pitch_body, PITCH_TRANSITION_FRONT_P2-0.1f,
							_pitch_transition_start_p2);

		// disable mc yaw control once the plane has picked up speed
		_mc_yaw_weight = 0.0f;
		_mc_roll_weight = 1.0f-weight*2;
		_mc_pitch_weight = 1.0f-weight;
		_v_att_sp->thrust =_thrust_transition_start+math::constrain((H-H*(weight*2-1.0f)*(weight*2-1.0f)),0.0f,H);//THROTTLE_TRANSITION_MAX*scale;

	}else if (_vtol_schedule.flight_mode == TRANSITION_FRONT_P3) {
		_v_att_sp->pitch_body =_params_tailsitter.trans_p3_f_pitch/57.3f-1.57f;
		// disable mc yaw control once the plane has picked up speed
		_mc_yaw_weight = 0.0f;
		_mc_roll_weight = 0.0f;
		_mc_pitch_weight = 0.0f;
		_v_att_sp->thrust =_thrust_transition_start;
	}else if(_vtol_schedule.flight_mode == TRANSITION_BACK_P1) {
		/*float weight=fabsf((euler.theta()-_pitch_transition_start)/(PITCH_TRANSITION_BACK_P1-_pitch_transition_start));
		float scale=time_since_trans_start/ ( _params->back_trans_duration);
		_v_att_sp->pitch_body =_pitch_transition_start+fabsf(PITCH_TRANSITION_BACK_P1-_pitch_transition_start+ 0.1f)*(scale)*scale;
		_v_att_sp->pitch_body = math::constrain(_v_att_sp->pitch_body, -2.0f, PITCH_TRANSITION_BACK_P1 + 0.1f);
		_mc_yaw_weight =0.0f;
		_mc_roll_weight=0.0f;
		_mc_pitch_weight=weight;
		_v_att_sp->thrust=_thrust_transition_start;
		_pitch_transition_start_p2= euler.theta();*/

		int rk = int(time_since_trans_start* 400);//1e-6f;
		if (rk > 799) rk = 799;
		float ground_speed_2=_local_pos->vx*_local_pos->vx+_local_pos->vy*_local_pos->vy;
		//float weight = (hrt_absolute_time() - _vtol_schedule.transition_start)*1e-6f/3.0f;
		_v_att_sp->pitch_body = state_back[1][rk] / 57.3f - 1.57f;
		_v_att_sp->thrust = state_back[2][rk] + 0.2f*(_local_pos->vz-state_back[0][rk]);// 0.8f * (_local_pos->vz - state_back[0][rk]);
		//if (euler.theta() > -0.785f) {
		if (rk > 600) {
			_mc_yaw_weight = 1.0f;//1.0f - weight;
			_mc_roll_weight = 1.0f;//1.0f - weight;
		}
		else {
			_mc_yaw_weight = float(rk) / float(600);//1.0f - weight;
			_mc_roll_weight = float(rk) / float(600);//1.0f - weight;
		}
		_mc_pitch_weight = 0.5;//(ground_speed_2*ground_speed_2-4.0f)/100.0f;
		if (ground_speed_2 > 0) {

		}
		if (_mc_pitch_weight > 1.0f) _mc_pitch_weight = 1.0f;
		if (_mc_pitch_weight < 0.0f) _mc_pitch_weight = 0.0f;
	}
	else if (_vtol_schedule.flight_mode == TRANSITION_BACK_P2) {
		float scale=(hrt_absolute_time()-_time_transition_start_p2)*1e-6f/_params_tailsitter.trans_b_p2_dur;
		if (!flag_idle_mc) {
			flag_idle_mc = set_idle_mc();
		}

		// create time dependant pitch angle set point stating at -pi/2 + 0.2 rad overlap over the switch value
		//xj-zhang俯仰角设定值应当在垂直坐标系中给出，直接设置到0附近过于暴力
		//_v_att_sp->pitch_body = M_PI_2_F + _pitch_transition_start + fabsf(PITCH_TRANSITION_BACK + 1.57f) *
		_v_att_sp->pitch_body =_pitch_transition_start_p2+fabsf(PITCH_TRANSITION_BACK_P2-_pitch_transition_start_p2)*scale;
		_v_att_sp->pitch_body = math::constrain(_v_att_sp->pitch_body, PITCH_TRANSITION_BACK_P1, PITCH_TRANSITION_BACK_P2 + 0.1f);

		// keep yaw disabled
		_mc_yaw_weight = 0.0f;
		// smoothly move control weight to MC
		_mc_roll_weight = 1.0f;
		_mc_pitch_weight=1.0f;
		//xj-zhang test
		_v_att_sp->thrust=_mc_virtual_att_sp->thrust;//_thrust_transition_start;
	}
	_v_att_sp->roll_body = 0.0f;
	_v_att_sp->yaw_body = _yaw_transition;
	if(_vtol_schedule.flight_mode == TRANSITION_BACK_P3){
		_v_att_sp->pitch_body =0.0f;
		_v_att_sp->roll_body = 0.0f;
		_v_att_sp->yaw_body=euler.psi();
		// P3 阶段保持姿态
		_mc_yaw_weight = 1.0f;
		_mc_roll_weight = 1.0f;
		_mc_pitch_weight = 1.0f;
		_v_att_sp->thrust =_thrust_transition_start;
	}
	//xj-zhang

	_mc_roll_weight = math::constrain(_mc_roll_weight, 0.0f, 1.0f);
	_mc_yaw_weight = math::constrain(_mc_yaw_weight, 0.0f, 1.0f);
	_mc_pitch_weight = math::constrain(_mc_pitch_weight, 0.0f, 1.0f);

	// compute desired attitude and thrust setpoint for the transition

	_v_att_sp->timestamp = hrt_absolute_time();
	//xj-zhang
	_v_att_sp->pitch_body+=-(_filter_manual_pitch.apply(_manual->x))*_params_tailsitter.manual_pitch_max/57.3f;
	_v_att_sp->roll_body+=_filter_manual_roll.apply(_manual->y)*_params_tailsitter.manual_roll_max/57.3f;
	_v_att_sp->yaw_body+=_filter_manual_yaw.apply(_manual->r)*_params_tailsitter.manual_yaw_max/57.3f;
	_v_att_sp->thrust +=_manual->z-_munual_thr_start+_params_tailsitter.height_p*(float)atan(_local_pos->z-_z_start)/1.57f;
	_v_att_sp->thrust = math::constrain(_v_att_sp->thrust,_params_tailsitter.trans_thr_min,0.9f);
	matrix::Quatf q_sp = matrix::Eulerf(_v_att_sp->roll_body, _v_att_sp->pitch_body, _v_att_sp->yaw_body);
	q_sp.copyTo(_v_att_sp->q_d);
	_v_att_sp->q_d_valid = true;
}

void Tailsitter::waiting_on_tecs()
{
	// copy the last trust value from the front transition
	_v_att_sp->thrust = _thrust_transition;
}

void Tailsitter::update_mc_state()
{
	VtolType::update_mc_state();
}

void Tailsitter::update_fw_state()
{
	VtolType::update_fw_state();
}

/**
* Write data to actuator output topic.
*/
void Tailsitter::fill_actuator_outputs()
{
	_actuators_out_0->timestamp = hrt_absolute_time();
	_actuators_out_0->timestamp_sample = _actuators_mc_in->timestamp_sample;

	_actuators_out_1->timestamp = hrt_absolute_time();
	_actuators_out_1->timestamp_sample = _actuators_fw_in->timestamp_sample;

	switch (_vtol_mode) {
	case ROTARY_WING:
		_actuators_out_0->control[actuator_controls_s::INDEX_ROLL] = _actuators_mc_in->control[actuator_controls_s::INDEX_ROLL];
		_actuators_out_0->control[actuator_controls_s::INDEX_PITCH] =
			_actuators_mc_in->control[actuator_controls_s::INDEX_PITCH];
		_actuators_out_0->control[actuator_controls_s::INDEX_YAW] = _actuators_mc_in->control[actuator_controls_s::INDEX_YAW];
		_actuators_out_0->control[actuator_controls_s::INDEX_THROTTLE] =
			_actuators_mc_in->control[actuator_controls_s::INDEX_THROTTLE];

		if (_params->elevons_mc_lock) {
			_actuators_out_1->control[0] = 0;
			_actuators_out_1->control[1] = 0;

		} else {
			// NOTE: There is no mistake in the line below, multicopter yaw axis is controlled by elevon roll actuation!
			_actuators_out_1->control[actuator_controls_s::INDEX_ROLL] =
				_actuators_mc_in->control[actuator_controls_s::INDEX_YAW];	//roll elevon
			_actuators_out_1->control[actuator_controls_s::INDEX_PITCH] =
				_actuators_mc_in->control[actuator_controls_s::INDEX_PITCH];	//pitch elevon
		}

		break;

	case FIXED_WING:
		// in fixed wing mode we use engines only for providing thrust, no moments are generated
		if(_params_tailsitter.yaw_control_flag==1){
			_actuators_out_0->control[actuator_controls_s::INDEX_ROLL] =  _actuators_fw_in->control[actuator_controls_s::INDEX_YAW];
		}	// yaw
		else
			_actuators_out_0->control[actuator_controls_s::INDEX_ROLL] = 0;	// yaw
		_actuators_out_0->control[actuator_controls_s::INDEX_PITCH] = 0;//_actuators_fw_in->control[actuator_controls_s::INDEX_PITCH]*1.0f;
		_actuators_out_0->control[actuator_controls_s::INDEX_YAW] = 0;
		_actuators_out_0->control[actuator_controls_s::INDEX_THROTTLE] =
			_actuators_fw_in->control[actuator_controls_s::INDEX_THROTTLE];

		_actuators_out_1->control[actuator_controls_s::INDEX_ROLL] =
			-_actuators_fw_in->control[actuator_controls_s::INDEX_ROLL];	// roll elevon
		_actuators_out_1->control[actuator_controls_s::INDEX_PITCH] =
			_actuators_fw_in->control[actuator_controls_s::INDEX_PITCH];	// pitch elevon
		_actuators_out_1->control[actuator_controls_s::INDEX_YAW] =
			_actuators_fw_in->control[actuator_controls_s::INDEX_YAW];	// yaw
		_actuators_out_1->control[actuator_controls_s::INDEX_THROTTLE] =
			_actuators_fw_in->control[actuator_controls_s::INDEX_THROTTLE];	// throttle
		break;

	case TRANSITION_TO_FW:
	case TRANSITION_TO_MC:
		// in transition engines are mixed by weight (BACK TRANSITION ONLY)
		//xj-zhang
		//mc_pitch_weight在P2阶段均匀减小到0，mc_roll_weight 在P2阶段以2倍速度减小到0
		if(_params_tailsitter.yaw_control_flag==1)
			_actuators_out_0->control[actuator_controls_s::INDEX_ROLL] =_actuators_mc_in->control[actuator_controls_s::INDEX_ROLL]* _mc_roll_weight
				+_actuators_fw_in->control[actuator_controls_s::INDEX_YAW]*(1- _mc_pitch_weight);
		else
			_actuators_out_0->control[actuator_controls_s::INDEX_ROLL] =_actuators_mc_in->control[actuator_controls_s::INDEX_ROLL]* _mc_roll_weight;
		_actuators_out_0->control[actuator_controls_s::INDEX_PITCH] =_actuators_mc_in->control[actuator_controls_s::INDEX_PITCH] * _mc_pitch_weight;
		_actuators_out_0->control[actuator_controls_s::INDEX_YAW] = _actuators_mc_in->control[actuator_controls_s::INDEX_YAW] *_mc_yaw_weight;
		_actuators_out_0->control[actuator_controls_s::INDEX_THROTTLE] =
			_actuators_mc_in->control[actuator_controls_s::INDEX_THROTTLE];

		// NOTE: There is no mistake in the line below, multicopter yaw axis is controlled by elevon roll actuation!
		_actuators_out_1->control[actuator_controls_s::INDEX_ROLL] =_actuators_mc_in->control[actuator_controls_s::INDEX_YAW]*_mc_yaw_weight+
		-_actuators_fw_in->control[actuator_controls_s::INDEX_ROLL]* (1 - _mc_roll_weight);
		_actuators_out_1->control[actuator_controls_s::INDEX_PITCH] =
			_actuators_mc_in->control[actuator_controls_s::INDEX_PITCH] * _mc_pitch_weight+
			//_actuators_fw_in->control[actuator_controls_s::INDEX_PITCH] *(1 - _mc_pitch_weight);
			(_actuators_fw_in->control[actuator_controls_s::INDEX_PITCH] + _params_tailsitter.fw_pitch_trim) *(1 - _mc_pitch_weight);
		_actuators_out_1->control[actuator_controls_s::INDEX_THROTTLE] =
			_actuators_fw_in->control[actuator_controls_s::INDEX_THROTTLE];
		break;
	}
}
